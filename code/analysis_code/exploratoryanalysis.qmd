---
title: "Total Amount of Vaccinations Among Black population in the Target Zip Codes"
output: 
  html_document
echo: FALSE 
---

# Library

```{r}
library(here)
library(readxl) #for loading Excel files
library(dplyr) #for data processing/cleaning
library(tidyr)
library(ggplot2)
library(reshape2) #reshaping data from wide to long format
library(plotly) #creating an interactive line plot 
```

# Analysis of the Amount of Vaccinations Among Black population in Each Target Zip Code

## Zip code: 31701

### Combining Vaccination data from the 31701 zip from Sept-Feb
```{r}
# Loading September 31701
data_location1 = here("data", "processed_data", "Zip_31701", "processed_data_31701_Sept.rds")
processed_data_31701_Sept = readRDS(data_location1)

# Loading October 31701 and joining september and october 
data_location2 = here("data", "processed_data", "Zip_31701", "processed_data_31701_Oct.rds")
processed_data_31701_Oct = readRDS(data_location2)
processed_combined <- left_join(processed_data_31701_Sept, processed_data_31701_Oct, by = c("FIPS" = "FIPS"))

# Loading November 31701
data_location3 = here("data", "processed_data", "Zip_31701", "processed_data_31701_Nov.rds")
processed_data_31701_Nov = readRDS(data_location3)
processed_combined <- left_join(processed_combined, processed_data_31701_Nov, by = c("FIPS" = "FIPS"))

# Loading December 31701
data_location4 = here("data", "processed_data", "Zip_31701", "processed_data_31701_Dec.rds")
processed_data_31701_Dec = readRDS(data_location4)
processed_combined <- left_join(processed_combined, processed_data_31701_Dec, by = c("FIPS" = "FIPS"))

# Loading January 31701
data_location5 = here("data", "processed_data", "Zip_31701", "processed_data_31701_Jan.rds")
processed_data_31701_Jan = readRDS(data_location5)
processed_combined <- left_join(processed_combined, processed_data_31701_Jan, by = c("FIPS" = "FIPS"))

# Loading February 31701
data_location6 = here("data", "processed_data", "Zip_31701", "processed_data_31701_Feb.rds")
processed_data_31701_Feb = readRDS(data_location6)
processed_combined_31701 <- left_join(processed_combined, processed_data_31701_Feb, by = c("FIPS" = "FIPS"))
```

### Combining Population data from the 31701 zip from Sept-Feb
```{r}
# Loading September 31701
data_location1 = here("data", "processed_data", "Zip_31701", "processed_POP_data_31701_Sept.rds")
processed_POP_data_31701_Sept = readRDS(data_location1)

# Loading October 31701 and joining september and october 
data_location2 = here("data", "processed_data", "Zip_31701", "processed_POP_data_31701_Oct.rds")
processed_POP_data_31701_Oct = readRDS(data_location2)
processed_POP_combined <- left_join(processed_POP_data_31701_Sept, processed_POP_data_31701_Oct, by = c("FIPS" = "FIPS"))

# Loading November 31701
data_location3 = here("data", "processed_data", "Zip_31701", "processed_POP_data_31701_Nov.rds")
processed_POP_data_31701_Nov = readRDS(data_location3)
processed_POP_combined <- left_join(processed_POP_combined, processed_POP_data_31701_Nov, by = c("FIPS" = "FIPS"))

# Loading December 31701
data_location4 = here("data", "processed_data", "Zip_31701", "processed_POP_data_31701_Dec.rds")
processed_POP_data_31701_Dec = readRDS(data_location4)
processed_POP_combined <- left_join(processed_POP_combined, processed_POP_data_31701_Dec, by = c("FIPS" = "FIPS"))

# Loading January 31701
data_location5 = here("data", "processed_data", "Zip_31701", "processed_POP_data_31701_Jan.rds")
processed_POP_data_31701_Jan = readRDS(data_location5)
processed_POP_combined <- left_join(processed_POP_combined, processed_POP_data_31701_Jan, by = c("FIPS" = "FIPS"))

# Loading February 31701
data_location6 = here("data", "processed_data", "Zip_31701", "processed_POP_data_31701_Feb.rds")
processed_POP_data_31701_Feb = readRDS(data_location6)
processed_POP_combined_31701 <- left_join(processed_POP_combined, processed_POP_data_31701_Feb, by = c("FIPS" = "FIPS"))
```

### Saving the combined data for Black population for future use. Will be useful when stratifying the African American population by age and gender

```{r}
save_data_location = here("data", "processed_data","Zip_31701", "processed_combined_31701.rds")
saveRDS(processed_combined_31701, file = save_data_location)
```

```{r}
save_data_location = here("data", "processed_data","Zip_31701", "processed_POP_combined_31701.rds")
saveRDS(processed_POP_combined_31701, file = save_data_location)
```

### Dropping all variables except for total black variables in order to obtain vaccination rates of all Black population in the 31701 zip code

#### Using the select() function to subset the data frame by columns that start with "total_black_vax" which are variables with a total count of Black population with at least one dose of the COVID-19 vaccine by month

```{r}
processed_combined_31701_total_black = processed_combined_31701 %>% select(starts_with("total_black_vax"))
```

```{r}
processed_combined_31701_total_black_POP = processed_POP_combined_31701 %>% select(starts_with("total_black_POP"))
```

### Summing vaccination numbers
```{r}
#Summing each column for each month 
sum(processed_combined_31701_total_black$total_black_vax_Sept_17) 
sum(processed_combined_31701_total_black$total_black_vax_Oct_28) 
sum(processed_combined_31701_total_black$total_black_vax_Nov_24) 
sum(processed_combined_31701_total_black$total_black_vax_Dec_29) 
sum(processed_combined_31701_total_black$total_black_vax_Jan_26) 
sum(processed_combined_31701_total_black$total_black_vax_Feb_26) 
```

### Summing population numbers
```{r}
#Summing each column for each month 
sum(processed_combined_31701_total_black_POP$total_black_POP_Sept_17) 
sum(processed_combined_31701_total_black_POP$total_black_POP_Oct_28) 
sum(processed_combined_31701_total_black_POP$total_black_POP_Nov_24) 
sum(processed_combined_31701_total_black_POP$total_black_POP_Dec_29) 
sum(processed_combined_31701_total_black_POP$total_black_POP_Jan_26) 
sum(processed_combined_31701_total_black_POP$total_black_POP_Feb_26) 
```

#Separating sums by month into a data fram consisting of two variables: Date and VAX_RATE #Date contains months September-February #Total contains the vaccination totals for each month

```{r}
Sum_by_month_31701 = data.frame(Date = c("Sep","Oct","Nov","Dec","Jan","Feb"),
                               VAX_RATE = c(7797/12768, 7780/12768, 7755/12897, 7773/12897, 7792/12897, 7817/12897)) 
```

### gglot2: Creating a line plot for the vaccination totals by month for the African American population in the 31701 zip code

```{r}
plot_31701_total_black_vax_rate = Sum_by_month_31701 %>% 
  ggplot(aes(Date, VAX_RATE, group=1)) + 
  geom_point() + geom_line() + 
  scale_x_discrete(limits = c("Sep","Oct","Nov","Dec","Jan","Feb"))

#Adding a customization title for the plot 
plot_31701_total_black_vax_rate = plot_31701_total_black_vax_rate + 
  ggtitle("Vaccination Rates for Black Population in the 31701 Zipcode") + 
  theme(plot.title = 
          element_text(color="red", size=10, face="bold.italic"))
plot_31701_total_black_vax_rate
```

### Save plot
```{r}
#save figure
ggsave(filename = here("results","31701_total_black_vax_rate.png"), plot=plot_31701_total_black_vax_rate)
```


### Turning ggplot into an interactive plot

```{r}
plotly_31701_total_black_vax_rate = ggplotly(plot_31701_total_black_vax_rate)
plotly_31701_total_black_vax_rate
```


## Zip code: 31705

### Combining Vaccination data from the 31705 zip from Sept-Feb
```{r}
# Loading September 31705
data_location1 = here("data", "processed_data", "Zip_31705", "processed_data_31705_Sept.rds")
processed_data_31705_Sept = readRDS(data_location1)

# Loading October 31705 and joining september and october 
data_location2 = here("data", "processed_data", "Zip_31705", "processed_data_31705_Oct.rds")
processed_data_31705_Oct = readRDS(data_location2)
processed_combined <- left_join(processed_data_31705_Sept, processed_data_31705_Oct, by = c("FIPS" = "FIPS"))

# Loading November 31705
data_location3 = here("data", "processed_data", "Zip_31705", "processed_data_31705_Nov.rds")
processed_data_31705_Nov = readRDS(data_location3)
processed_combined <- left_join(processed_combined, processed_data_31705_Nov, by = c("FIPS" = "FIPS"))

# Loading December 31705
data_location4 = here("data", "processed_data", "Zip_31705", "processed_data_31705_Dec.rds")
processed_data_31705_Dec = readRDS(data_location4)
processed_combined <- left_join(processed_combined, processed_data_31705_Dec, by = c("FIPS" = "FIPS"))

# Loading January 31705
data_location5 = here("data", "processed_data", "Zip_31705", "processed_data_31705_Jan.rds")
processed_data_31705_Jan = readRDS(data_location5)
processed_combined <- left_join(processed_combined, processed_data_31705_Jan, by = c("FIPS" = "FIPS"))

# Loading February 31705
data_location6 = here("data", "processed_data", "Zip_31705", "processed_data_31705_Feb.rds")
processed_data_31705_Feb = readRDS(data_location6)
processed_combined_31705 <- left_join(processed_combined, processed_data_31705_Feb, by = c("FIPS" = "FIPS"))
```

### Combining Population data from the 31705 zip from Sept-Feb
```{r}
# Loading September 31705
data_location1 = here("data", "processed_data", "Zip_31705", "processed_POP_data_31705_Sept.rds")
processed_POP_data_31705_Sept = readRDS(data_location1)

# Loading October 31705 and joining september and october 
data_location2 = here("data", "processed_data", "Zip_31705", "processed_POP_data_31705_Oct.rds")
processed_POP_data_31705_Oct = readRDS(data_location2)
processed_POP_combined <- left_join(processed_POP_data_31705_Sept, processed_POP_data_31705_Oct, by = c("FIPS" = "FIPS"))

# Loading November 31705
data_location3 = here("data", "processed_data", "Zip_31705", "processed_POP_data_31705_Nov.rds")
processed_POP_data_31705_Nov = readRDS(data_location3)
processed_POP_combined <- left_join(processed_POP_combined, processed_POP_data_31705_Nov, by = c("FIPS" = "FIPS"))

# Loading December 31705
data_location4 = here("data", "processed_data", "Zip_31705", "processed_POP_data_31705_Dec.rds")
processed_POP_data_31705_Dec = readRDS(data_location4)
processed_POP_combined <- left_join(processed_POP_combined, processed_POP_data_31705_Dec, by = c("FIPS" = "FIPS"))

# Loading January 31705
data_location5 = here("data", "processed_data", "Zip_31705", "processed_POP_data_31705_Jan.rds")
processed_POP_data_31705_Jan = readRDS(data_location5)
processed_POP_combined <- left_join(processed_POP_combined, processed_POP_data_31705_Jan, by = c("FIPS" = "FIPS"))

# Loading February 31705
data_location6 = here("data", "processed_data", "Zip_31705", "processed_POP_data_31705_Feb.rds")
processed_POP_data_31705_Feb = readRDS(data_location6)
processed_POP_combined_31705 <- left_join(processed_POP_combined, processed_POP_data_31705_Feb, by = c("FIPS" = "FIPS"))
```

### Saving the combined data for Black population for future use. Will be useful when stratifying the African American population by age and gender

```{r}
save_data_location = here("data", "processed_data","Zip_31705", "processed_combined_31705.rds")
saveRDS(processed_combined_31705, file = save_data_location)
```

```{r}
save_data_location = here("data", "processed_data","Zip_31705", "processed_POP_combined_31705.rds")
saveRDS(processed_POP_combined_31705, file = save_data_location)
```

### Dropping all variables except for total black variables in order to obtain vaccination rates of all Black population in the 31705 zip code

#### Using the select() function to subset the data frame by columns that start with "total_black_vax" which are variables with a total count of Black population with at least one dose of the COVID-19 vaccine by month

```{r}
processed_combined_31705_total_black = processed_combined_31705 %>% select(starts_with("total_black_vax"))
```

```{r}
processed_combined_31705_total_black_POP = processed_POP_combined_31705 %>% select(starts_with("total_black_POP"))
```

### Summing vaccination numbers
```{r}
#Summing each column for each month 
sum(processed_combined_31705_total_black$total_black_vax_Sept_17) 
sum(processed_combined_31705_total_black$total_black_vax_Oct_28) 
sum(processed_combined_31705_total_black$total_black_vax_Nov_24) 
sum(processed_combined_31705_total_black$total_black_vax_Dec_29) 
sum(processed_combined_31705_total_black$total_black_vax_Jan_26) 
sum(processed_combined_31705_total_black$total_black_vax_Feb_26) 
```

### Summing population numbers
```{r}
#Summing each column for each month 
sum(processed_combined_31705_total_black_POP$total_black_POP_Sept_17) 
sum(processed_combined_31705_total_black_POP$total_black_POP_Oct_28) 
sum(processed_combined_31705_total_black_POP$total_black_POP_Nov_24) 
sum(processed_combined_31705_total_black_POP$total_black_POP_Dec_29) 
sum(processed_combined_31705_total_black_POP$total_black_POP_Jan_26) 
sum(processed_combined_31705_total_black_POP$total_black_POP_Feb_26) 
```

#Separating sums by month into a data fram consisting of two variables: Date and VAX_RATE #Date contains months September-February #Total contains the vaccination totals for each month

```{r}
Sum_by_month_31705 = data.frame(Date = c("Sep","Oct","Nov","Dec","Jan","Feb"),
                               VAX_RATE = c(10383/21603, 10327/21572, 10303/21722, 10301/21887, 10337/21887, 10348/21887)) 
```

### gglot2: Creating a line plot for the vaccination totals by month for the African American population in the 31705 zip code

```{r}
plot_31705_total_black_vax_rate = Sum_by_month_31705 %>% 
  ggplot(aes(Date, VAX_RATE, group=1)) + 
  geom_point() + geom_line() + 
  scale_x_discrete(limits = c("Sep","Oct","Nov","Dec","Jan","Feb"))

#Adding a customization title for the plot 
plot_31705_total_black_vax_rate = plot_31705_total_black_vax_rate + 
  ggtitle("Vaccination Rates for Black Population in the 31705 Zipcode") + 
  theme(plot.title = 
          element_text(color="red", size=10, face="bold.italic"))
plot_31705_total_black_vax_rate
```

### Save plot
```{r}
#save figure
ggsave(filename = here("results","31705_total_black_vax_rate.png"), plot=plot_31705_total_black_vax_rate)
```


### Turning ggplot into an interactive plot

```{r}
plotly_31705_total_black_vax_rate = ggplotly(plot_31705_total_black_vax_rate)
plotly_31705_total_black_vax_rate
```


## Zip code: 31707

### Combining Vaccination data from the 31707 zip from Sept-Feb
```{r}
# Loading September 31707
data_location1 = here("data", "processed_data", "Zip_31707", "processed_data_31707_Sept.rds")
processed_data_31707_Sept = readRDS(data_location1)

# Loading October 31707 and joining september and october 
data_location2 = here("data", "processed_data", "Zip_31707", "processed_data_31707_Oct.rds")
processed_data_31707_Oct = readRDS(data_location2)
processed_combined <- left_join(processed_data_31707_Sept, processed_data_31707_Oct, by = c("FIPS" = "FIPS"))

# Loading November 31707
data_location3 = here("data", "processed_data", "Zip_31707", "processed_data_31707_Nov.rds")
processed_data_31707_Nov = readRDS(data_location3)
processed_combined <- left_join(processed_combined, processed_data_31707_Nov, by = c("FIPS" = "FIPS"))

# Loading December 31707
data_location4 = here("data", "processed_data", "Zip_31707", "processed_data_31707_Dec.rds")
processed_data_31707_Dec = readRDS(data_location4)
processed_combined <- left_join(processed_combined, processed_data_31707_Dec, by = c("FIPS" = "FIPS"))

# Loading January 31707
data_location5 = here("data", "processed_data", "Zip_31707", "processed_data_31707_Jan.rds")
processed_data_31707_Jan = readRDS(data_location5)
processed_combined <- left_join(processed_combined, processed_data_31707_Jan, by = c("FIPS" = "FIPS"))

# Loading February 31707
data_location6 = here("data", "processed_data", "Zip_31707", "processed_data_31707_Feb.rds")
processed_data_31707_Feb = readRDS(data_location6)
processed_combined_31707 <- left_join(processed_combined, processed_data_31707_Feb, by = c("FIPS" = "FIPS"))
```

### Combining Population data from the 31707 zip from Sept-Feb
```{r}
# Loading September 31707
data_location1 = here("data", "processed_data", "Zip_31707", "processed_POP_data_31707_Sept.rds")
processed_POP_data_31707_Sept = readRDS(data_location1)

# Loading October 31707 and joining september and october 
data_location2 = here("data", "processed_data", "Zip_31707", "processed_POP_data_31707_Oct.rds")
processed_POP_data_31707_Oct = readRDS(data_location2)
processed_POP_combined <- left_join(processed_POP_data_31707_Sept, processed_POP_data_31707_Oct, by = c("FIPS" = "FIPS"))

# Loading November 31707
data_location3 = here("data", "processed_data", "Zip_31707", "processed_POP_data_31707_Nov.rds")
processed_POP_data_31707_Nov = readRDS(data_location3)
processed_POP_combined <- left_join(processed_POP_combined, processed_POP_data_31707_Nov, by = c("FIPS" = "FIPS"))

# Loading December 31707
data_location4 = here("data", "processed_data", "Zip_31707", "processed_POP_data_31707_Dec.rds")
processed_POP_data_31707_Dec = readRDS(data_location4)
processed_POP_combined <- left_join(processed_POP_combined, processed_POP_data_31707_Dec, by = c("FIPS" = "FIPS"))

# Loading January 31707
data_location5 = here("data", "processed_data", "Zip_31707", "processed_POP_data_31707_Jan.rds")
processed_POP_data_31707_Jan = readRDS(data_location5)
processed_POP_combined <- left_join(processed_POP_combined, processed_POP_data_31707_Jan, by = c("FIPS" = "FIPS"))

# Loading February 31707
data_location6 = here("data", "processed_data", "Zip_31707", "processed_POP_data_31707_Feb.rds")
processed_POP_data_31707_Feb = readRDS(data_location6)
processed_POP_combined_31707 <- left_join(processed_POP_combined, processed_POP_data_31707_Feb, by = c("FIPS" = "FIPS"))
```

### Saving the combined data for Black population for future use. Will be useful when stratifying the African American population by age and gender

```{r}
save_data_location = here("data", "processed_data","Zip_31707", "processed_combined_31707.rds")
saveRDS(processed_combined_31707, file = save_data_location)
```

```{r}
save_data_location = here("data", "processed_data","Zip_31707", "processed_POP_combined_31707.rds")
saveRDS(processed_POP_combined_31707, file = save_data_location)
```

### Dropping all variables except for total black variables in order to obtain vaccination rates of all Black population in the 31707 zip code

#### Using the select() function to subset the data frame by columns that start with "total_black_vax" which are variables with a total count of Black population with at least one dose of the COVID-19 vaccine by month

```{r}
processed_combined_31707_total_black = processed_combined_31707 %>% select(starts_with("total_black_vax"))
```

```{r}
processed_combined_31707_total_black_POP = processed_POP_combined_31707 %>% select(starts_with("total_black_POP"))
```

### Summing vaccination numbers
```{r}
#Summing each column for each month 
sum(processed_combined_31707_total_black$total_black_vax_Sept_17) 
sum(processed_combined_31707_total_black$total_black_vax_Oct_28) 
sum(processed_combined_31707_total_black$total_black_vax_Nov_24) 
sum(processed_combined_31707_total_black$total_black_vax_Dec_29) 
sum(processed_combined_31707_total_black$total_black_vax_Jan_26) 
sum(processed_combined_31707_total_black$total_black_vax_Feb_26) 
```

### Summing population numbers
```{r}
#Summing each column for each month 
sum(processed_combined_31707_total_black_POP$total_black_POP_Sept_17) 
sum(processed_combined_31707_total_black_POP$total_black_POP_Oct_28) 
sum(processed_combined_31707_total_black_POP$total_black_POP_Nov_24) 
sum(processed_combined_31707_total_black_POP$total_black_POP_Dec_29) 
sum(processed_combined_31707_total_black_POP$total_black_POP_Jan_26) 
sum(processed_combined_31707_total_black_POP$total_black_POP_Feb_26) 
```

#Separating sums by month into a data fram consisting of two variables: Date and VAX_RATE #Date contains months September-February #Total contains the vaccination totals for each month

```{r}
Sum_by_month_31707 = data.frame(Date = c("Sep","Oct","Nov","Dec","Jan","Feb"),
                               VAX_RATE = c(9035/18045, 8985/18045, 8997/18045, 9005/18081, 9035/18081, 9042/18165)) 
```

### gglot2: Creating a line plot for the vaccination totals by month for the African American population in the 31707 zip code

```{r}
plot_31707_total_black_vax_rate = Sum_by_month_31707 %>% 
  ggplot(aes(Date, VAX_RATE, group=1)) + 
  geom_point() + geom_line() + 
  scale_x_discrete(limits = c("Sep","Oct","Nov","Dec","Jan","Feb"))

#Adding a customization title for the plot 
plot_31707_total_black_vax_rate = plot_31707_total_black_vax_rate + 
  ggtitle("Vaccination Rates for Black Population in the 31707 Zipcode") + 
  theme(plot.title = 
          element_text(color="red", size=10, face="bold.italic"))
plot_31707_total_black_vax_rate
```

### Save plot
```{r}
#save figure
ggsave(filename = here("results","31707_total_black_vax_rate.png"), plot=plot_31707_total_black_vax_rate)
```


### Turning ggplot into an interactive plot

```{r}
plotly_31707_total_black_vax_rate = ggplotly(plot_31707_total_black_vax_rate)
plotly_31707_total_black_vax_rate
```

# Vaccinations by Gender Among Black Population in the Target Zip Codes

## Zip code: 31701

### Loading the `processed_combined_31701.rds` 
```{r}
save_data_location = here("data", "processed_data","Zip_31701", "processed_combined_31701.rds")
processed_combined_31701 = readRDS(save_data_location)
```

### Loading the `processed_POP_combined_31701.rds`
```{r}
save_data_location = here("data", "processed_data","Zip_31701", "processed_POP_combined_31701.rds")
processed_POP_combined_31701 = readRDS(save_data_location)
```

### Dropping all variables except for black males and black females within 31701

#### Isolating Gender Variables form Vaccination data and Population data

```{r}
processed_combined_31701_Gender_black = processed_combined_31701 %>% select(matches("^total_(mblack|fblack)_vax"))
```

```{r}
processed_POP_combined_31701_Gender_black = processed_POP_combined_31701 %>% select(matches("^total_(mblack|fblack)_POP"))
```


### Summing each Month for vaccination data 
```{r}
#Summing for black males by month 
sum(processed_combined_31701_Gender_black$total_mblack_vax_Sept_17) 
sum(processed_combined_31701_Gender_black$total_mblack_vax_Oct_28) 
sum(processed_combined_31701_Gender_black$total_mblack_vax_Nov_24) 
sum(processed_combined_31701_Gender_black$total_mblack_vax_Dec_29) 
sum(processed_combined_31701_Gender_black$total_mblack_vax_Jan_26) 
sum(processed_combined_31701_Gender_black$total_mblack_vax_Feb_26)

#summing for black females by month 
sum(processed_combined_31701_Gender_black$total_fblack_vax_Sept_17) 
sum(processed_combined_31701_Gender_black$total_fblack_vax_Oct_28) 
sum(processed_combined_31701_Gender_black$total_fblack_vax_Nov_24) 
sum(processed_combined_31701_Gender_black$total_fblack_vax_Dec_29) 
sum(processed_combined_31701_Gender_black$total_fblack_vax_Jan_26) 
sum(processed_combined_31701_Gender_black$total_fblack_vax_Feb_26) 
```

### Summing each Month for population data
```{r}
#Summing for black males by month 
sum(processed_POP_combined_31701_Gender_black$total_mblack_POP_Sept_17) 
sum(processed_POP_combined_31701_Gender_black$total_mblack_POP_Oct_28) 
sum(processed_POP_combined_31701_Gender_black$total_mblack_POP_Nov_24) 
sum(processed_POP_combined_31701_Gender_black$total_mblack_POP_Dec_29) 
sum(processed_POP_combined_31701_Gender_black$total_mblack_POP_Jan_26) 
sum(processed_POP_combined_31701_Gender_black$total_mblack_POP_Feb_26)

#summing for black females by month 
sum(processed_POP_combined_31701_Gender_black$total_fblack_POP_Sept_17) 
sum(processed_POP_combined_31701_Gender_black$total_fblack_POP_Oct_28) 
sum(processed_POP_combined_31701_Gender_black$total_fblack_POP_Nov_24) 
sum(processed_POP_combined_31701_Gender_black$total_fblack_POP_Dec_29) 
sum(processed_POP_combined_31701_Gender_black$total_fblack_POP_Jan_26) 
sum(processed_POP_combined_31701_Gender_black$total_fblack_POP_Feb_26) 
```

#Separating sums by month into a data fram consisting of two variables: Date and Total Date contains months September-February #Total contains the vaccination totals for each month

```{r}
Gender_Sum_by_month_31701 = data.frame(Date = c("Sep","Oct","Nov","Dec","Jan","Feb"),
                          Male_Total = c(3371/5981, 3358/5981, 3368/5981, 3379/5981, 3387/5981, 3397/5981),
                          Female_Total = c(4426/6787, 4422/6787, 4387/6916, 4394/6916, 4405/6916, 4420/6916))
```

### Converting the Gender_Sum_by_month_31701 to long data in order to plot
```{r}
Gender_Sum_by_month_31701_long = reshape2::melt(Gender_Sum_by_month_31701, id = "Date")
```


### Changing "variable" to "Gender" and "value" to "Vaccination_total"

```{r}
Gender_Sum_by_month_31701_long <- Gender_Sum_by_month_31701_long %>% 
  rename("Gender" = "variable") %>% 
  rename("Vaccination_rate" = "value")
```


### gglot2: Creating a line plot for the vaccination totals by month for the Black population by gender in the 31701 zip code

```{r}
plot_Gender_black_vax = Gender_Sum_by_month_31701_long %>% 
                     ggplot(aes(Date, Vaccination_rate, 
                                group = Gender, 
                                color = Gender)) + 
                     geom_point() + geom_line() + 
                     scale_x_discrete(limits = c("Sep","Oct","Nov","Dec","Jan","Feb"))
#adding a title to the plot 
plot_Gender_black_vax = plot_Gender_black_vax + 
  ggtitle("Vaccination Rates for Black population by Gender in 31701") + 
  theme(plot.title = 
          element_text(color="red", size=10, face="bold.italic")) + 
  labs(y = "Vaccination Total")
plot_Gender_black_vax
```

### Save plot
```{r}
#save figure
ggsave(filename = here("results","31701_Gender_black_vax.png"), plot=plot_Gender_black_vax)
```


### Turning ggplot into an interactive plot

```{r}
plotly_plot_Gender_black_vax = ggplotly(plot_Gender_black_vax)
plotly_plot_Gender_black_vax
```


## Zip code: 31705

### Loading the `processed_combined_31705.rds` 
```{r}
save_data_location = here("data", "processed_data","Zip_31705", "processed_combined_31705.rds")
processed_combined_31705 = readRDS(save_data_location)
```

### Loading the `processed_POP_combined_31705.rds`
```{r}
save_data_location = here("data", "processed_data","Zip_31705", "processed_POP_combined_31705.rds")
processed_POP_combined_31705 = readRDS(save_data_location)
```


### Dropping all variables except for black males and black females within 31705

#### Isolating Gender Variables form Vaccination data and Population data

```{r}
processed_combined_31705_Gender_black = processed_combined_31705 %>% select(matches("^total_(mblack|fblack)_vax"))
```

```{r}
processed_POP_combined_31705_Gender_black = processed_POP_combined_31705 %>% select(matches("^total_(mblack|fblack)_POP"))
```


### Summing each Month for vaccination data 
```{r}
#Summing for black males by month 
sum(processed_combined_31705_Gender_black$total_mblack_vax_Sept_17) 
sum(processed_combined_31705_Gender_black$total_mblack_vax_Oct_28) 
sum(processed_combined_31705_Gender_black$total_mblack_vax_Nov_24) 
sum(processed_combined_31705_Gender_black$total_mblack_vax_Dec_29) 
sum(processed_combined_31705_Gender_black$total_mblack_vax_Jan_26) 
sum(processed_combined_31705_Gender_black$total_mblack_vax_Feb_26)

#summing for black females by month 
sum(processed_combined_31705_Gender_black$total_fblack_vax_Sept_17) 
sum(processed_combined_31705_Gender_black$total_fblack_vax_Oct_28) 
sum(processed_combined_31705_Gender_black$total_fblack_vax_Nov_24) 
sum(processed_combined_31705_Gender_black$total_fblack_vax_Dec_29) 
sum(processed_combined_31705_Gender_black$total_fblack_vax_Jan_26) 
sum(processed_combined_31705_Gender_black$total_fblack_vax_Feb_26) 
```

### Summing each Month for population data
```{r}
#Summing for black males by month 
sum(processed_POP_combined_31705_Gender_black$total_mblack_POP_Sept_17) 
sum(processed_POP_combined_31705_Gender_black$total_mblack_POP_Oct_28) 
sum(processed_POP_combined_31705_Gender_black$total_mblack_POP_Nov_24) 
sum(processed_POP_combined_31705_Gender_black$total_mblack_POP_Dec_29) 
sum(processed_POP_combined_31705_Gender_black$total_mblack_POP_Jan_26) 
sum(processed_POP_combined_31705_Gender_black$total_mblack_POP_Feb_26)

#summing for black females by month 
sum(processed_POP_combined_31705_Gender_black$total_fblack_POP_Sept_17) 
sum(processed_POP_combined_31705_Gender_black$total_fblack_POP_Oct_28) 
sum(processed_POP_combined_31705_Gender_black$total_fblack_POP_Nov_24) 
sum(processed_POP_combined_31705_Gender_black$total_fblack_POP_Dec_29) 
sum(processed_POP_combined_31705_Gender_black$total_fblack_POP_Jan_26) 
sum(processed_POP_combined_31705_Gender_black$total_fblack_POP_Feb_26) 
```

#Separating sums by month into a data fram consisting of two variables: Date and Total Date contains months September-February #Total contains the vaccination totals for each month

```{r}
Gender_Sum_by_month_31705 = data.frame(Date = c("Sep","Oct","Nov","Dec","Jan","Feb"),
                          Male_Total = c(4394/9885, 4397/9854, 4399/10004, 4391/10004, 4403/10004, 4399/10004),
                          Female_Total = c(5989/11718, 5930/11718, 5904/11718, 5910/11883, 5934/11883, 5949/11883))
```

### Converting the Gender_Sum_by_month_31705 to long data in order to plot
```{r}
Gender_Sum_by_month_31705_long = reshape2::melt(Gender_Sum_by_month_31705, id = "Date")
```


### Changing "variable" to "Gender" and "value" to "Vaccination_total"

```{r}
Gender_Sum_by_month_31705_long <- Gender_Sum_by_month_31705_long %>% 
  rename("Gender" = "variable") %>% 
  rename("Vaccination_rate" = "value")
```


### gglot2: Creating a line plot for the vaccination totals by month for the Black population by gender in the 31705 zip code

```{r}
plot_Gender_black_vax = Gender_Sum_by_month_31705_long %>% 
                     ggplot(aes(Date, Vaccination_rate, 
                                group = Gender, 
                                color = Gender)) + 
                     geom_point() + geom_line() + 
                     scale_x_discrete(limits = c("Sep","Oct","Nov","Dec","Jan","Feb"))
#adding a title to the plot 
plot_Gender_black_vax = plot_Gender_black_vax + 
  ggtitle("Vaccination Rates for Black population by Gender in 31705") + 
  theme(plot.title = 
          element_text(color="red", size=10, face="bold.italic")) + 
  labs(y = "Vaccination Total")
plot_Gender_black_vax
```

### Save plot
```{r}
#save figure
ggsave(filename = here("results","31705_Gender_black_vax.png"), plot=plot_Gender_black_vax)
```


### Turning ggplot into an interactive plot

```{r}
plotly_plot_Gender_black_vax = ggplotly(plot_Gender_black_vax)
plotly_plot_Gender_black_vax
```

## Zip code: 31707

### Loading the `processed_combined_31707.rds` 
```{r}
save_data_location = here("data", "processed_data","Zip_31707", "processed_combined_31707.rds")
processed_combined_31707 = readRDS(save_data_location)
```

### Loading the `processed_POP_combined_31707.rds`
```{r}
save_data_location = here("data", "processed_data","Zip_31707", "processed_POP_combined_31707.rds")
processed_POP_combined_31707 = readRDS(save_data_location)
```


### Dropping all variables except for black males and black females within 31707

#### Isolating Gender Variables form Vaccination data and Population data

```{r}
processed_combined_31707_Gender_black = processed_combined_31707 %>% select(matches("^total_(mblack|fblack)_vax"))
```

```{r}
processed_POP_combined_31707_Gender_black = processed_POP_combined_31707 %>% select(matches("^total_(mblack|fblack)_POP"))
```


### Summing each Month for vaccination data 
```{r}
#Summing for black males by month 
sum(processed_combined_31707_Gender_black$total_mblack_vax_Sept_17) 
sum(processed_combined_31707_Gender_black$total_mblack_vax_Oct_28) 
sum(processed_combined_31707_Gender_black$total_mblack_vax_Nov_24) 
sum(processed_combined_31707_Gender_black$total_mblack_vax_Dec_29) 
sum(processed_combined_31707_Gender_black$total_mblack_vax_Jan_26) 
sum(processed_combined_31707_Gender_black$total_mblack_vax_Feb_26)

#summing for black females by month 
sum(processed_combined_31707_Gender_black$total_fblack_vax_Sept_17) 
sum(processed_combined_31707_Gender_black$total_fblack_vax_Oct_28) 
sum(processed_combined_31707_Gender_black$total_fblack_vax_Nov_24) 
sum(processed_combined_31707_Gender_black$total_fblack_vax_Dec_29) 
sum(processed_combined_31707_Gender_black$total_fblack_vax_Jan_26) 
sum(processed_combined_31707_Gender_black$total_fblack_vax_Feb_26) 
```

### Summing each Month for population data
```{r}
#Summing for black males by month 
sum(processed_POP_combined_31707_Gender_black$total_mblack_POP_Sept_17) 
sum(processed_POP_combined_31707_Gender_black$total_mblack_POP_Oct_28) 
sum(processed_POP_combined_31707_Gender_black$total_mblack_POP_Nov_24) 
sum(processed_POP_combined_31707_Gender_black$total_mblack_POP_Dec_29) 
sum(processed_POP_combined_31707_Gender_black$total_mblack_POP_Jan_26) 
sum(processed_POP_combined_31707_Gender_black$total_mblack_POP_Feb_26)

#summing for black females by month 
sum(processed_POP_combined_31707_Gender_black$total_fblack_POP_Sept_17) 
sum(processed_POP_combined_31707_Gender_black$total_fblack_POP_Oct_28) 
sum(processed_POP_combined_31707_Gender_black$total_fblack_POP_Nov_24) 
sum(processed_POP_combined_31707_Gender_black$total_fblack_POP_Dec_29) 
sum(processed_POP_combined_31707_Gender_black$total_fblack_POP_Jan_26) 
sum(processed_POP_combined_31707_Gender_black$total_fblack_POP_Feb_26) 
```

#Separating sums by month into a data fram consisting of two variables: Date and Total Date contains months September-February #Total contains the vaccination totals for each month

```{r}
Gender_Sum_by_month_31707 = data.frame(Date = c("Sep","Oct","Nov","Dec","Jan","Feb"),
                          Male_Total = c(3698/8232, 3674/8232, 3678/8232, 3680/8232, 3684/8232, 3681/8232),
                          Female_Total = c(5337/9813, 5311/9813, 5319/9813, 5325/9849, 5351/9849, 5361/9933))
```

### Converting the Gender_Sum_by_month_31707 to long data in order to plot
```{r}
Gender_Sum_by_month_31707_long = reshape2::melt(Gender_Sum_by_month_31707, id = "Date")
```


### Changing "variable" to "Gender" and "value" to "Vaccination_total"

```{r}
Gender_Sum_by_month_31707_long <- Gender_Sum_by_month_31707_long %>% 
  rename("Gender" = "variable") %>% 
  rename("Vaccination_rate" = "value")
```


### gglot2: Creating a line plot for the vaccination totals by month for the Black population by gender in the 31707 zip code

```{r}
plot_Gender_black_vax = Gender_Sum_by_month_31707_long %>% 
                     ggplot(aes(Date, Vaccination_rate, 
                                group = Gender, 
                                color = Gender)) + 
                     geom_point() + geom_line() + 
                     scale_x_discrete(limits = c("Sep","Oct","Nov","Dec","Jan","Feb"))
#adding a title to the plot 
plot_Gender_black_vax = plot_Gender_black_vax + 
  ggtitle("Vaccination Rates for Black population by Gender in 31707") + 
  theme(plot.title = 
          element_text(color="red", size=10, face="bold.italic")) + 
  labs(y = "Vaccination Total")
plot_Gender_black_vax
```

### Save plot
```{r}
#save figure
ggsave(filename = here("results","31707_Gender_black_vax.png"), plot=plot_Gender_black_vax)
```


### Turning ggplot into an interactive plot

```{r}
plotly_plot_Gender_black_vax = ggplotly(plot_Gender_black_vax)
plotly_plot_Gender_black_vax
```

# Total Amount of vaccinations by Age among Black population in the target zip codes

## Zip code: 31701

### Loading the `processed_combined_31701.rds` file from `analysiscode.qmd`

```{r}
save_data_location = here("data", "processed_data","Zip_31701", "processed_combined_31701.rds")
processed_combined_31701 = readRDS(save_data_location)
```

### Loading the `processed_POP_combined_31701.rds`
```{r}
save_data_location = here("data", "processed_data","Zip_31701", "processed_POP_combined_31701.rds")
processed_POP_combined_31701 = readRDS(save_data_location)
```

### Dropping all variables except for black age groups within 31701

#### Using the select() function to subset the data frame by columns that start with an age group 

```{r}
processed_combined_31701_Age_black = processed_combined_31701 %>% 
  select(starts_with("total_05_09"), starts_with("total_10_17"), starts_with("total_18_44"), starts_with("total_45_64"), starts_with("total_65Plus"))
```

```{r}
processed_POP_combined_31701_Age_black = processed_POP_combined_31701 %>% 
  select(starts_with("total_05_09"), starts_with("total_10_17"), starts_with("total_18_44"), starts_with("total_45_64"), starts_with("total_65Plus"))
```

### Summing each Month variable by age group by month for vaccinations
```{r}
#Summing for ages 5-9 by month 
sum(processed_combined_31701_Age_black$total_05_09_vax_Sept_17) 
sum(processed_combined_31701_Age_black$total_05_09_vax_Oct_28) 
sum(processed_combined_31701_Age_black$total_05_09_vax_Nov_24) 
sum(processed_combined_31701_Age_black$total_05_09_vax_Dec_29) 
sum(processed_combined_31701_Age_black$total_05_09_vax_Jan_26) 
sum(processed_combined_31701_Age_black$total_05_09_vax_Feb_26)

#Summing for ages 10-17 by month 
sum(processed_combined_31701_Age_black$total_10_17_vax_Sept_17) 
sum(processed_combined_31701_Age_black$total_10_17_vax_Oct_28) 
sum(processed_combined_31701_Age_black$total_10_17_vax_Nov_24) 
sum(processed_combined_31701_Age_black$total_10_17_vax_Dec_29) 
sum(processed_combined_31701_Age_black$total_10_17_vax_Jan_26) 
sum(processed_combined_31701_Age_black$total_10_17_vax_Feb_26)

#Summing for ages 18-44 by month 
sum(processed_combined_31701_Age_black$total_18_44_vax_Sept_17) 
sum(processed_combined_31701_Age_black$total_18_44_vax_Oct_28) 
sum(processed_combined_31701_Age_black$total_18_44_vax_Nov_24) 
sum(processed_combined_31701_Age_black$total_18_44_vax_Dec_29) 
sum(processed_combined_31701_Age_black$total_18_44_vax_Jan_26) 
sum(processed_combined_31701_Age_black$total_18_44_vax_Feb_26)

#Summing for ages 45-64 by month 
sum(processed_combined_31701_Age_black$total_45_64_vax_Sept_17) 
sum(processed_combined_31701_Age_black$total_45_64_vax_Oct_28) 
sum(processed_combined_31701_Age_black$total_45_64_vax_Nov_24) 
sum(processed_combined_31701_Age_black$total_45_64_vax_Dec_29) 
sum(processed_combined_31701_Age_black$total_45_64_vax_Jan_26) 
sum(processed_combined_31701_Age_black$total_45_64_vax_Feb_26)

#Summing for ages 65+ by month 
sum(processed_combined_31701_Age_black$total_65Plus_vax_Sept_17) 
sum(processed_combined_31701_Age_black$total_65Plus_vax_Oct_28) 
sum(processed_combined_31701_Age_black$total_65Plus_vax_Nov_24) 
sum(processed_combined_31701_Age_black$total_65Plus_vax_Dec_29) 
sum(processed_combined_31701_Age_black$total_65Plus_vax_Jan_26) 
sum(processed_combined_31701_Age_black$total_65Plus_vax_Feb_26)

```

### Summing each Month variable by age group by month for Population
```{r}
#Summing for ages 5-9 by month 
sum(processed_POP_combined_31701_Age_black$total_05_09_POP_Sept_17) 
sum(processed_POP_combined_31701_Age_black$total_05_09_POP_Oct_28) 
sum(processed_POP_combined_31701_Age_black$total_05_09_POP_Nov_24) 
sum(processed_POP_combined_31701_Age_black$total_05_09_POP_Dec_29) 
sum(processed_POP_combined_31701_Age_black$total_05_09_POP_Jan_26) 
sum(processed_POP_combined_31701_Age_black$total_05_09_POP_Feb_26)

#Summing for ages 10-17 by month 
sum(processed_POP_combined_31701_Age_black$total_10_17_POP_Sept_17) 
sum(processed_POP_combined_31701_Age_black$total_10_17_POP_Oct_28) 
sum(processed_POP_combined_31701_Age_black$total_10_17_POP_Nov_24) 
sum(processed_POP_combined_31701_Age_black$total_10_17_POP_Dec_29) 
sum(processed_POP_combined_31701_Age_black$total_10_17_POP_Jan_26) 
sum(processed_POP_combined_31701_Age_black$total_10_17_POP_Feb_26)

#Summing for ages 18-44 by month 
sum(processed_POP_combined_31701_Age_black$total_18_44_POP_Sept_17) 
sum(processed_POP_combined_31701_Age_black$total_18_44_POP_Oct_28) 
sum(processed_POP_combined_31701_Age_black$total_18_44_POP_Nov_24) 
sum(processed_POP_combined_31701_Age_black$total_18_44_POP_Dec_29) 
sum(processed_POP_combined_31701_Age_black$total_18_44_POP_Jan_26) 
sum(processed_POP_combined_31701_Age_black$total_18_44_POP_Feb_26)

#Summing for ages 45-64 by month 
sum(processed_POP_combined_31701_Age_black$total_45_64_POP_Sept_17) 
sum(processed_POP_combined_31701_Age_black$total_45_64_POP_Oct_28) 
sum(processed_POP_combined_31701_Age_black$total_45_64_POP_Nov_24) 
sum(processed_POP_combined_31701_Age_black$total_45_64_POP_Dec_29) 
sum(processed_POP_combined_31701_Age_black$total_45_64_POP_Jan_26) 
sum(processed_POP_combined_31701_Age_black$total_45_64_POP_Feb_26)

#Summing for ages 65+ by month 
sum(processed_POP_combined_31701_Age_black$total_65Plus_POP_Sept_17) 
sum(processed_POP_combined_31701_Age_black$total_65Plus_POP_Oct_28) 
sum(processed_POP_combined_31701_Age_black$total_65Plus_POP_Nov_24) 
sum(processed_POP_combined_31701_Age_black$total_65Plus_POP_Dec_29) 
sum(processed_POP_combined_31701_Age_black$total_65Plus_POP_Jan_26) 
sum(processed_POP_combined_31701_Age_black$total_65Plus_POP_Feb_26)

```


### Separating sums by month into a data fram consisting of two variables: Date and Total Date contains months September-February #Total contains the vaccination totals for each month

```{r}
Age_Sum_by_month_31701 = data.frame(Date = c("Sep","Oct","Nov","Dec","Jan","Feb"),
                          Age_05_09 = c(123/1058, 126/1058, 126/1058, 127/1058, 127/1058, 128/1058),
                          Age_10_17 = c(642/1560, 635/1560, 633/1560, 637/1560, 630/1560, 629/1560),
                          Age_18_44 = c(3310/5054, 3316/5054, 3313/5054, 3323/5054, 3325/5054, 3331/5054),
                          Age_45_64 = c(3229/4628, 3244/4628, 3239/4628, 3259/4628, 3264/4628, 3258/4628),
                          Age_65Plus = c(2576/2886, 2570/2886, 2569/2886, 2574/2886, 2568/2886, 2572/2886))
                          
```

### Converting the Age_Sum_by_month_31701 to long data in order to plot
```{r}
Age_Sum_by_month_31701_long = reshape2::melt(Age_Sum_by_month_31701, id = "Date")
```


### Changing "variable" to "Age" and "value" to "Vaccination_total"

```{r}
Age_Sum_by_month_31701_long <- Age_Sum_by_month_31701_long %>% 
  rename("Age" = "variable") %>% 
  rename("Vaccination_rate" = "value")
```


### gglot2: Creating a line plot for the vaccination totals by month for the Black population by Age in the 31701 zip code

```{r}
plot_Age_black_vax = Age_Sum_by_month_31701_long %>% 
                     ggplot(aes(Date, Vaccination_rate, 
                                group = Age, 
                                color = Age)) + 
                     geom_point() + geom_line() + 
                     scale_x_discrete(limits = c("Sep","Oct","Nov","Dec","Jan","Feb"))
#adding a title to the plot 
plot_Age_black_vax = plot_Age_black_vax + 
  ggtitle("Vaccination Rates for Black population by Age in 31701") + 
  theme(plot.title = 
          element_text(color="red", size=10, face="bold.italic")) + 
  labs(y = "Vaccination Total")
plot_Age_black_vax
```


### Save plot
```{r}
#save figure
ggsave(filename = here("results","31701_Age_black_vax.png"), plot=plot_Age_black_vax)
```


### Turning ggplot into an interactive plot

```{r}
plotly_plot_Age_black_vax = ggplotly(plot_Age_black_vax)
plotly_plot_Age_black_vax
```

## Zip code: 31705

### Loading the `processed_combined_31705.rds` file from `analysiscode.qmd`

```{r}
save_data_location = here("data", "processed_data","Zip_31705", "processed_combined_31705.rds")
processed_combined_31705 = readRDS(save_data_location)
```

### Loading the `processed_POP_combined_31705.rds`
```{r}
save_data_location = here("data", "processed_data","Zip_31705", "processed_POP_combined_31705.rds")
processed_POP_combined_31705 = readRDS(save_data_location)
```

### Dropping all variables except for black age groups within 31705

#### Using the select() function to subset the data frame by columns that start with an age group 

```{r}
processed_combined_31705_Age_black = processed_combined_31705 %>% 
  select(starts_with("total_05_09"), starts_with("total_10_17"), starts_with("total_18_44"), starts_with("total_45_64"), starts_with("total_65Plus"))
```

```{r}
processed_POP_combined_31705_Age_black = processed_POP_combined_31705 %>% 
  select(starts_with("total_05_09"), starts_with("total_10_17"), starts_with("total_18_44"), starts_with("total_45_64"), starts_with("total_65Plus"))
```

### Summing each Month variable by age group by month for vaccinations
```{r}
#Summing for ages 5-9 by month 
sum(processed_combined_31705_Age_black$total_05_09_vax_Sept_17) 
sum(processed_combined_31705_Age_black$total_05_09_vax_Oct_28) 
sum(processed_combined_31705_Age_black$total_05_09_vax_Nov_24) 
sum(processed_combined_31705_Age_black$total_05_09_vax_Dec_29) 
sum(processed_combined_31705_Age_black$total_05_09_vax_Jan_26) 
sum(processed_combined_31705_Age_black$total_05_09_vax_Feb_26)

#Summing for ages 10-17 by month 
sum(processed_combined_31705_Age_black$total_10_17_vax_Sept_17) 
sum(processed_combined_31705_Age_black$total_10_17_vax_Oct_28) 
sum(processed_combined_31705_Age_black$total_10_17_vax_Nov_24) 
sum(processed_combined_31705_Age_black$total_10_17_vax_Dec_29) 
sum(processed_combined_31705_Age_black$total_10_17_vax_Jan_26) 
sum(processed_combined_31705_Age_black$total_10_17_vax_Feb_26)

#Summing for ages 18-44 by month 
sum(processed_combined_31705_Age_black$total_18_44_vax_Sept_17) 
sum(processed_combined_31705_Age_black$total_18_44_vax_Oct_28) 
sum(processed_combined_31705_Age_black$total_18_44_vax_Nov_24) 
sum(processed_combined_31705_Age_black$total_18_44_vax_Dec_29) 
sum(processed_combined_31705_Age_black$total_18_44_vax_Jan_26) 
sum(processed_combined_31705_Age_black$total_18_44_vax_Feb_26)

#Summing for ages 45-64 by month 
sum(processed_combined_31705_Age_black$total_45_64_vax_Sept_17) 
sum(processed_combined_31705_Age_black$total_45_64_vax_Oct_28) 
sum(processed_combined_31705_Age_black$total_45_64_vax_Nov_24) 
sum(processed_combined_31705_Age_black$total_45_64_vax_Dec_29) 
sum(processed_combined_31705_Age_black$total_45_64_vax_Jan_26) 
sum(processed_combined_31705_Age_black$total_45_64_vax_Feb_26)

#Summing for ages 65+ by month 
sum(processed_combined_31705_Age_black$total_65Plus_vax_Sept_17) 
sum(processed_combined_31705_Age_black$total_65Plus_vax_Oct_28) 
sum(processed_combined_31705_Age_black$total_65Plus_vax_Nov_24) 
sum(processed_combined_31705_Age_black$total_65Plus_vax_Dec_29) 
sum(processed_combined_31705_Age_black$total_65Plus_vax_Jan_26) 
sum(processed_combined_31705_Age_black$total_65Plus_vax_Feb_26)

```

### Summing each Month variable by age group by month for Population
```{r}
#Summing for ages 5-9 by month 
sum(processed_POP_combined_31705_Age_black$total_05_09_POP_Sept_17) 
sum(processed_POP_combined_31705_Age_black$total_05_09_POP_Oct_28) 
sum(processed_POP_combined_31705_Age_black$total_05_09_POP_Nov_24) 
sum(processed_POP_combined_31705_Age_black$total_05_09_POP_Dec_29) 
sum(processed_POP_combined_31705_Age_black$total_05_09_POP_Jan_26) 
sum(processed_POP_combined_31705_Age_black$total_05_09_POP_Feb_26)

#Summing for ages 10-17 by month 
sum(processed_POP_combined_31705_Age_black$total_10_17_POP_Sept_17) 
sum(processed_POP_combined_31705_Age_black$total_10_17_POP_Oct_28) 
sum(processed_POP_combined_31705_Age_black$total_10_17_POP_Nov_24) 
sum(processed_POP_combined_31705_Age_black$total_10_17_POP_Dec_29) 
sum(processed_POP_combined_31705_Age_black$total_10_17_POP_Jan_26) 
sum(processed_POP_combined_31705_Age_black$total_10_17_POP_Feb_26)

#Summing for ages 18-44 by month 
sum(processed_POP_combined_31705_Age_black$total_18_44_POP_Sept_17) 
sum(processed_POP_combined_31705_Age_black$total_18_44_POP_Oct_28) 
sum(processed_POP_combined_31705_Age_black$total_18_44_POP_Nov_24) 
sum(processed_POP_combined_31705_Age_black$total_18_44_POP_Dec_29) 
sum(processed_POP_combined_31705_Age_black$total_18_44_POP_Jan_26) 
sum(processed_POP_combined_31705_Age_black$total_18_44_POP_Feb_26)

#Summing for ages 45-64 by month 
sum(processed_POP_combined_31705_Age_black$total_45_64_POP_Sept_17) 
sum(processed_POP_combined_31705_Age_black$total_45_64_POP_Oct_28) 
sum(processed_POP_combined_31705_Age_black$total_45_64_POP_Nov_24) 
sum(processed_POP_combined_31705_Age_black$total_45_64_POP_Dec_29) 
sum(processed_POP_combined_31705_Age_black$total_45_64_POP_Jan_26) 
sum(processed_POP_combined_31705_Age_black$total_45_64_POP_Feb_26)

#Summing for ages 65+ by month 
sum(processed_POP_combined_31705_Age_black$total_65Plus_POP_Sept_17) 
sum(processed_POP_combined_31705_Age_black$total_65Plus_POP_Oct_28) 
sum(processed_POP_combined_31705_Age_black$total_65Plus_POP_Nov_24) 
sum(processed_POP_combined_31705_Age_black$total_65Plus_POP_Dec_29) 
sum(processed_POP_combined_31705_Age_black$total_65Plus_POP_Jan_26) 
sum(processed_POP_combined_31705_Age_black$total_65Plus_POP_Feb_26)

```


### Separating sums by month into a data fram consisting of two variables: Date and Total Date contains months September-February #Total contains the vaccination totals for each month

```{r}
Age_Sum_by_month_31705 = data.frame(Date = c("Sep","Oct","Nov","Dec","Jan","Feb"),
                          Age_05_09 = c(210/1639, 211/1639, 209/1639, 201/1639, 202/1639, 202/1639),
                          Age_10_17 = c(1159/3311, 1171/3311, 1169/3311, 1163/3311, 1168/3311, 1167/3311),
                          Age_18_44 = c(5201/11978, 5215/11978, 5239/11978, 5263/11978, 5278/11978, 5281/11978),
                          Age_45_64 = c(4380/6468, 4381/6468, 4366/6468, 4364/6468, 4367/6468, 4367/6468),
                          Age_65Plus = c(2983/3497, 3000/3497, 2997/3497, 2997/3497, 2994/3497, 2989/3497))
                          
```

### Converting the Age_Sum_by_month_31705 to long data in order to plot
```{r}
Age_Sum_by_month_31705_long = reshape2::melt(Age_Sum_by_month_31705, id = "Date")
```


### Changing "variable" to "Age" and "value" to "Vaccination_total"

```{r}
Age_Sum_by_month_31705_long <- Age_Sum_by_month_31705_long %>% 
  rename("Age" = "variable") %>% 
  rename("Vaccination_rate" = "value")
```


### gglot2: Creating a line plot for the vaccination totals by month for the Black population by Age in the 31705 zip code

```{r}
plot_Age_black_vax = Age_Sum_by_month_31705_long %>% 
                     ggplot(aes(Date, Vaccination_rate, 
                                group = Age, 
                                color = Age)) + 
                     geom_point() + geom_line() + 
                     scale_x_discrete(limits = c("Sep","Oct","Nov","Dec","Jan","Feb"))
#adding a title to the plot 
plot_Age_black_vax = plot_Age_black_vax + 
  ggtitle("Vaccination Rates for Black population by Age in 31705") + 
  theme(plot.title = 
          element_text(color="red", size=10, face="bold.italic")) + 
  labs(y = "Vaccination Total")
plot_Age_black_vax
```


### Save plot
```{r}
#save figure
ggsave(filename = here("results","31705_Age_black_vax.png"), plot=plot_Age_black_vax)
```


### Turning ggplot into an interactive plot

```{r}
plotly_plot_Age_black_vax = ggplotly(plot_Age_black_vax)
plotly_plot_Age_black_vax
```


## Zip code: 31707

### Loading the `processed_combined_31707.rds` file from `analysiscode.qmd`

```{r}
save_data_location = here("data", "processed_data","Zip_31707", "processed_combined_31707.rds")
processed_combined_31707 = readRDS(save_data_location)
```

### Loading the `processed_POP_combined_31707.rds`
```{r}
save_data_location = here("data", "processed_data","Zip_31707", "processed_POP_combined_31707.rds")
processed_POP_combined_31707 = readRDS(save_data_location)
```

### Dropping all variables except for black age groups within 31707

#### Using the select() function to subset the data frame by columns that start with an age group 

```{r}
processed_combined_31707_Age_black = processed_combined_31707 %>% 
  select(starts_with("total_05_09"), starts_with("total_10_17"), starts_with("total_18_44"), starts_with("total_45_64"), starts_with("total_65Plus"))
```

```{r}
processed_POP_combined_31707_Age_black = processed_POP_combined_31707 %>% 
  select(starts_with("total_05_09"), starts_with("total_10_17"), starts_with("total_18_44"), starts_with("total_45_64"), starts_with("total_65Plus"))
```

### Summing each Month variable by age group by month for vaccinations
```{r}
#Summing for ages 5-9 by month 
sum(processed_combined_31707_Age_black$total_05_09_vax_Sept_17) 
sum(processed_combined_31707_Age_black$total_05_09_vax_Oct_28) 
sum(processed_combined_31707_Age_black$total_05_09_vax_Nov_24) 
sum(processed_combined_31707_Age_black$total_05_09_vax_Dec_29) 
sum(processed_combined_31707_Age_black$total_05_09_vax_Jan_26) 
sum(processed_combined_31707_Age_black$total_05_09_vax_Feb_26)

#Summing for ages 10-17 by month 
sum(processed_combined_31707_Age_black$total_10_17_vax_Sept_17) 
sum(processed_combined_31707_Age_black$total_10_17_vax_Oct_28) 
sum(processed_combined_31707_Age_black$total_10_17_vax_Nov_24) 
sum(processed_combined_31707_Age_black$total_10_17_vax_Dec_29) 
sum(processed_combined_31707_Age_black$total_10_17_vax_Jan_26) 
sum(processed_combined_31707_Age_black$total_10_17_vax_Feb_26)

#Summing for ages 18-44 by month 
sum(processed_combined_31707_Age_black$total_18_44_vax_Sept_17) 
sum(processed_combined_31707_Age_black$total_18_44_vax_Oct_28) 
sum(processed_combined_31707_Age_black$total_18_44_vax_Nov_24) 
sum(processed_combined_31707_Age_black$total_18_44_vax_Dec_29) 
sum(processed_combined_31707_Age_black$total_18_44_vax_Jan_26) 
sum(processed_combined_31707_Age_black$total_18_44_vax_Feb_26)

#Summing for ages 45-64 by month 
sum(processed_combined_31707_Age_black$total_45_64_vax_Sept_17) 
sum(processed_combined_31707_Age_black$total_45_64_vax_Oct_28) 
sum(processed_combined_31707_Age_black$total_45_64_vax_Nov_24) 
sum(processed_combined_31707_Age_black$total_45_64_vax_Dec_29) 
sum(processed_combined_31707_Age_black$total_45_64_vax_Jan_26) 
sum(processed_combined_31707_Age_black$total_45_64_vax_Feb_26)

#Summing for ages 65+ by month 
sum(processed_combined_31707_Age_black$total_65Plus_vax_Sept_17) 
sum(processed_combined_31707_Age_black$total_65Plus_vax_Oct_28) 
sum(processed_combined_31707_Age_black$total_65Plus_vax_Nov_24) 
sum(processed_combined_31707_Age_black$total_65Plus_vax_Dec_29) 
sum(processed_combined_31707_Age_black$total_65Plus_vax_Jan_26) 
sum(processed_combined_31707_Age_black$total_65Plus_vax_Feb_26)

```

### Summing each Month variable by age group by month for Population
```{r}
#Summing for ages 5-9 by month 
sum(processed_POP_combined_31707_Age_black$total_05_09_POP_Sept_17) 
sum(processed_POP_combined_31707_Age_black$total_05_09_POP_Oct_28) 
sum(processed_POP_combined_31707_Age_black$total_05_09_POP_Nov_24) 
sum(processed_POP_combined_31707_Age_black$total_05_09_POP_Dec_29) 
sum(processed_POP_combined_31707_Age_black$total_05_09_POP_Jan_26) 
sum(processed_POP_combined_31707_Age_black$total_05_09_POP_Feb_26)

#Summing for ages 10-17 by month 
sum(processed_POP_combined_31707_Age_black$total_10_17_POP_Sept_17) 
sum(processed_POP_combined_31707_Age_black$total_10_17_POP_Oct_28) 
sum(processed_POP_combined_31707_Age_black$total_10_17_POP_Nov_24) 
sum(processed_POP_combined_31707_Age_black$total_10_17_POP_Dec_29) 
sum(processed_POP_combined_31707_Age_black$total_10_17_POP_Jan_26) 
sum(processed_POP_combined_31707_Age_black$total_10_17_POP_Feb_26)

#Summing for ages 18-44 by month 
sum(processed_POP_combined_31707_Age_black$total_18_44_POP_Sept_17) 
sum(processed_POP_combined_31707_Age_black$total_18_44_POP_Oct_28) 
sum(processed_POP_combined_31707_Age_black$total_18_44_POP_Nov_24) 
sum(processed_POP_combined_31707_Age_black$total_18_44_POP_Dec_29) 
sum(processed_POP_combined_31707_Age_black$total_18_44_POP_Jan_26) 
sum(processed_POP_combined_31707_Age_black$total_18_44_POP_Feb_26)

#Summing for ages 45-64 by month 
sum(processed_POP_combined_31707_Age_black$total_45_64_POP_Sept_17) 
sum(processed_POP_combined_31707_Age_black$total_45_64_POP_Oct_28) 
sum(processed_POP_combined_31707_Age_black$total_45_64_POP_Nov_24) 
sum(processed_POP_combined_31707_Age_black$total_45_64_POP_Dec_29) 
sum(processed_POP_combined_31707_Age_black$total_45_64_POP_Jan_26) 
sum(processed_POP_combined_31707_Age_black$total_45_64_POP_Feb_26)

#Summing for ages 65+ by month 
sum(processed_POP_combined_31707_Age_black$total_65Plus_POP_Sept_17) 
sum(processed_POP_combined_31707_Age_black$total_65Plus_POP_Oct_28) 
sum(processed_POP_combined_31707_Age_black$total_65Plus_POP_Nov_24) 
sum(processed_POP_combined_31707_Age_black$total_65Plus_POP_Dec_29) 
sum(processed_POP_combined_31707_Age_black$total_65Plus_POP_Jan_26) 
sum(processed_POP_combined_31707_Age_black$total_65Plus_POP_Feb_26)

```


### Separating sums by month into a data fram consisting of two variables: Date and Total Date contains months September-February #Total contains the vaccination totals for each month

```{r}
Age_Sum_by_month_31707 = data.frame(Date = c("Sep","Oct","Nov","Dec","Jan","Feb"),
                          Age_05_09 = c(275/1583, 277/1702, 280/1702, 282/1702, 284/1702, 283/1702),
                          Age_10_17 = c(1109/3001, 1120/3001, 1125/3001, 1134/3001, 1136/3001, 1142/3001),
                          Age_18_44 = c(5903/11434, 5931/11434, 5943/11434, 5947/11434, 5960/11434, 5958/11434),
                          Age_45_64 = c(5130/6051, 5120/6051, 5125/6051, 5123/6051, 5133/6051, 5140/6051),
                          Age_65Plus = c(4200/4259, 4204/4259, 4195/4259, 4206/4259, 4202/4259, 4189/4259))
                          
```

### Converting the Age_Sum_by_month_31707 to long data in order to plot
```{r}
Age_Sum_by_month_31707_long = reshape2::melt(Age_Sum_by_month_31707, id = "Date")
```


### Changing "variable" to "Age" and "value" to "Vaccination_total"

```{r}
Age_Sum_by_month_31707_long <- Age_Sum_by_month_31707_long %>% 
  rename("Age" = "variable") %>% 
  rename("Vaccination_rate" = "value")
```


### gglot2: Creating a line plot for the vaccination totals by month for the Black population by Age in the 31707 zip code

```{r}
plot_Age_black_vax = Age_Sum_by_month_31707_long %>% 
                     ggplot(aes(Date, Vaccination_rate, 
                                group = Age, 
                                color = Age)) + 
                     geom_point() + geom_line() + 
                     scale_x_discrete(limits = c("Sep","Oct","Nov","Dec","Jan","Feb"))
#adding a title to the plot 
plot_Age_black_vax = plot_Age_black_vax + 
  ggtitle("Vaccination Rates for Black population by Age in 31707") + 
  theme(plot.title = 
          element_text(color="red", size=10, face="bold.italic")) + 
  labs(y = "Vaccination Total")
plot_Age_black_vax
```


### Save plot
```{r}
#save figure
ggsave(filename = here("results","31707_Age_black_vax.png"), plot=plot_Age_black_vax)
```


### Turning ggplot into an interactive plot

```{r}
plotly_plot_Age_black_vax = ggplotly(plot_Age_black_vax)
plotly_plot_Age_black_vax
```

# Analyzing Control Zip Codes by vaccination rate

## Zip code: 30815

### Combining Vaccination data from the 30815 zip from Sept-Feb
```{r}
# Loading September 30815
data_location1 = here("data", "processed_data", "Zip_30815", "processed_data_30815_Sept.rds")
processed_data_30815_Sept = readRDS(data_location1)

# Loading October 30815 and joining september and october 
data_location2 = here("data", "processed_data", "Zip_30815", "processed_data_30815_Oct.rds")
processed_data_30815_Oct = readRDS(data_location2)
processed_combined <- left_join(processed_data_30815_Sept, processed_data_30815_Oct, by = c("FIPS" = "FIPS"))

# Loading November 30815
data_location3 = here("data", "processed_data", "Zip_30815", "processed_data_30815_Nov.rds")
processed_data_30815_Nov = readRDS(data_location3)
processed_combined <- left_join(processed_combined, processed_data_30815_Nov, by = c("FIPS" = "FIPS"))

# Loading December 30815
data_location4 = here("data", "processed_data", "Zip_30815", "processed_data_30815_Dec.rds")
processed_data_30815_Dec = readRDS(data_location4)
processed_combined <- left_join(processed_combined, processed_data_30815_Dec, by = c("FIPS" = "FIPS"))

# Loading January 30815
data_location5 = here("data", "processed_data", "Zip_30815", "processed_data_30815_Jan.rds")
processed_data_30815_Jan = readRDS(data_location5)
processed_combined <- left_join(processed_combined, processed_data_30815_Jan, by = c("FIPS" = "FIPS"))

# Loading February 30815
data_location6 = here("data", "processed_data", "Zip_30815", "processed_data_30815_Feb.rds")
processed_data_30815_Feb = readRDS(data_location6)
processed_combined_30815 <- left_join(processed_combined, processed_data_30815_Feb, by = c("FIPS" = "FIPS"))
```

### Combining Population data from the 30815 zip from Sept-Feb
```{r}
# Loading September 30815
data_location1 = here("data", "processed_data", "Zip_30815", "processed_data_POP_30815_Sept.rds")
processed_data_POP_30815_Sept = readRDS(data_location1)

# Loading October 30815 and joining september and october 
data_location2 = here("data", "processed_data", "Zip_30815", "processed_data_POP_30815_Oct.rds")
processed_data_POP_30815_Oct = readRDS(data_location2)
processed_POP_combined <- left_join(processed_data_POP_30815_Sept, processed_data_POP_30815_Oct, by = c("FIPS" = "FIPS"))

# Loading November 30815
data_location3 = here("data", "processed_data", "Zip_30815", "processed_data_POP_30815_Nov.rds")
processed_data_POP_30815_Nov = readRDS(data_location3)
processed_POP_combined <- left_join(processed_POP_combined, processed_data_POP_30815_Nov, by = c("FIPS" = "FIPS"))

# Loading December 30815
data_location4 = here("data", "processed_data", "Zip_30815", "processed_data_POP_30815_Dec.rds")
processed_data_POP_30815_Dec = readRDS(data_location4)
processed_POP_combined <- left_join(processed_POP_combined, processed_data_POP_30815_Dec, by = c("FIPS" = "FIPS"))

# Loading January 30815
data_location5 = here("data", "processed_data", "Zip_30815", "processed_data_POP_30815_Jan.rds")
processed_data_POP_30815_Jan = readRDS(data_location5)
processed_POP_combined <- left_join(processed_POP_combined, processed_data_POP_30815_Jan, by = c("FIPS" = "FIPS"))

# Loading February 30815
data_location6 = here("data", "processed_data", "Zip_30815", "processed_data_POP_30815_Feb.rds")
processed_data_POP_30815_Feb = readRDS(data_location6)
processed_POP_combined_30815 <- left_join(processed_POP_combined, processed_data_POP_30815_Feb, by = c("FIPS" = "FIPS"))
```

### Saving the combined data for Black population for future use. Will be useful when stratifying the African American population by age and gender

```{r}
save_data_location = here("data", "processed_data","Zip_30815", "processed_combined_30815.rds")
saveRDS(processed_combined_30815, file = save_data_location)
```

```{r}
save_data_location = here("data", "processed_data","Zip_30815", "processed_POP_combined_30815.rds")
saveRDS(processed_POP_combined_30815, file = save_data_location)
```

### Dropping all variables except for total black variables in order to obtain vaccination rates of all Black population in the 30815 zip code

#### Using the select() function to subset the data frame by columns that start with "total_black_vax" which are variables with a total count of Black population with at least one dose of the COVID-19 vaccine by month

```{r}
processed_combined_30815_total_black = processed_combined_30815 %>% select(starts_with("total_black_vax"))
```

```{r}
processed_combined_30815_total_black_POP = processed_POP_combined_30815 %>% select(starts_with("total_black_POP"))
```

### Summing vaccination numbers
```{r}
#Summing each column for each month 
sum(processed_combined_30815_total_black$total_black_vax_Sept_17) 
sum(processed_combined_30815_total_black$total_black_vax_Oct_28) 
sum(processed_combined_30815_total_black$total_black_vax_Nov_24) 
sum(processed_combined_30815_total_black$total_black_vax_Dec_29) 
sum(processed_combined_30815_total_black$total_black_vax_Jan_26) 
sum(processed_combined_30815_total_black$total_black_vax_Feb_26) 
```

### Summing population numbers
```{r}
#Summing each column for each month 
sum(processed_combined_30815_total_black_POP$total_black_POP_Sept_17) 
sum(processed_combined_30815_total_black_POP$total_black_POP_Oct_28) 
sum(processed_combined_30815_total_black_POP$total_black_POP_Nov_24) 
sum(processed_combined_30815_total_black_POP$total_black_POP_Dec_29) 
sum(processed_combined_30815_total_black_POP$total_black_POP_Jan_26) 
sum(processed_combined_30815_total_black_POP$total_black_POP_Feb_26) 
```

#Separating sums by month into a data fram consisting of two variables: Date and VAX_RATE #Date contains months September-February #Total contains the vaccination totals for each month

```{r}
Sum_by_month_30815 = data.frame(Date = c("Sep","Oct","Nov","Dec","Jan","Feb"),
                               VAX_RATE = c(8758/19606, 8688/19736, 8639/19736, 8593/19736, 8623/19736, 8666/19736)) 
```

### gglot2: Creating a line plot for the vaccination totals by month for the African American population in the 30815 zip code

```{r}
plot_30815_total_black_vax_rate = Sum_by_month_30815 %>% 
  ggplot(aes(Date, VAX_RATE, group=1)) + 
  geom_point() + geom_line() + 
  scale_x_discrete(limits = c("Sep","Oct","Nov","Dec","Jan","Feb"))

#Adding a customization title for the plot 
plot_30815_total_black_vax_rate = plot_30815_total_black_vax_rate + 
  ggtitle("Vaccination Rates for Black Population in the 30815 Zipcode") + 
  theme(plot.title = 
          element_text(color="red", size=10, face="bold.italic"))
plot_30815_total_black_vax_rate
```

### Save plot
```{r}
#save figure
ggsave(filename = here("results","30815_total_black_vax_rate.png"), plot=plot_30815_total_black_vax_rate)
```


### Turning ggplot into an interactive plot

```{r}
plotly_30815_total_black_vax_rate = ggplotly(plot_30815_total_black_vax_rate)
plotly_30815_total_black_vax_rate
```

## 30815 by gender 

## Zip code: 30815

### Loading the `processed_combined_30815.rds` 
```{r}
save_data_location = here("data", "processed_data","Zip_30815", "processed_combined_30815.rds")
processed_combined_30815 = readRDS(save_data_location)
```

### Loading the `processed_POP_combined_30815.rds`
```{r}
save_data_location = here("data", "processed_data","Zip_30815", "processed_POP_combined_30815.rds")
processed_POP_combined_30815 = readRDS(save_data_location)
```

### Dropping all variables except for black males and black females within 30815

#### Isolating Gender Variables form Vaccination data and Population data

```{r}
processed_combined_30815_Gender_black = processed_combined_30815 %>% select(matches("^total_(mblack|fblack)_vax"))
```

```{r}
processed_POP_combined_30815_Gender_black = processed_POP_combined_30815 %>% select(matches("^total_(mblack|fblack)_POP"))
```


### Summing each Month for vaccination data 
```{r}
#Summing for black males by month 
sum(processed_combined_30815_Gender_black$total_mblack_vax_Sept_17) 
sum(processed_combined_30815_Gender_black$total_mblack_vax_Oct_28) 
sum(processed_combined_30815_Gender_black$total_mblack_vax_Nov_24) 
sum(processed_combined_30815_Gender_black$total_mblack_vax_Dec_29) 
sum(processed_combined_30815_Gender_black$total_mblack_vax_Jan_26) 
sum(processed_combined_30815_Gender_black$total_mblack_vax_Feb_26)

#summing for black females by month 
sum(processed_combined_30815_Gender_black$total_fblack_vax_Sept_17) 
sum(processed_combined_30815_Gender_black$total_fblack_vax_Oct_28) 
sum(processed_combined_30815_Gender_black$total_fblack_vax_Nov_24) 
sum(processed_combined_30815_Gender_black$total_fblack_vax_Dec_29) 
sum(processed_combined_30815_Gender_black$total_fblack_vax_Jan_26) 
sum(processed_combined_30815_Gender_black$total_fblack_vax_Feb_26) 
```

### Summing each Month for population data
```{r}
#Summing for black males by month 
sum(processed_POP_combined_30815_Gender_black$total_mblack_POP_Sept_17) 
sum(processed_POP_combined_30815_Gender_black$total_mblack_POP_Oct_28) 
sum(processed_POP_combined_30815_Gender_black$total_mblack_POP_Nov_24) 
sum(processed_POP_combined_30815_Gender_black$total_mblack_POP_Dec_29) 
sum(processed_POP_combined_30815_Gender_black$total_mblack_POP_Jan_26) 
sum(processed_POP_combined_30815_Gender_black$total_mblack_POP_Feb_26)

#summing for black females by month 
sum(processed_POP_combined_30815_Gender_black$total_fblack_POP_Sept_17) 
sum(processed_POP_combined_30815_Gender_black$total_fblack_POP_Oct_28) 
sum(processed_POP_combined_30815_Gender_black$total_fblack_POP_Nov_24) 
sum(processed_POP_combined_30815_Gender_black$total_fblack_POP_Dec_29) 
sum(processed_POP_combined_30815_Gender_black$total_fblack_POP_Jan_26) 
sum(processed_POP_combined_30815_Gender_black$total_fblack_POP_Feb_26) 
```

#Separating sums by month into a data fram consisting of two variables: Date and Total Date contains months September-February #Total contains the vaccination totals for each month

```{r}
Gender_Sum_by_month_30815 = data.frame(Date = c("Sep","Oct","Nov","Dec","Jan","Feb"),
                          Male_Total = c(3526/9066, 3514/9196, 3503/9196, 3484/9196, 3489/9196, 3498/9196),
                          Female_Total = c(5232/10540, 5174/10540, 5136/10540, 5109/10540, 5134/10540, 5168/10540))
```

### Converting the Gender_Sum_by_month_30815 to long data in order to plot
```{r}
Gender_Sum_by_month_30815_long = reshape2::melt(Gender_Sum_by_month_30815, id = "Date")
```


### Changing "variable" to "Gender" and "value" to "Vaccination_total"

```{r}
Gender_Sum_by_month_30815_long <- Gender_Sum_by_month_30815_long %>% 
  rename("Gender" = "variable") %>% 
  rename("Vaccination_rate" = "value")
```


### gglot2: Creating a line plot for the vaccination totals by month for the Black population by gender in the 30815 zip code

```{r}
plot_Gender_black_vax = Gender_Sum_by_month_30815_long %>% 
                     ggplot(aes(Date, Vaccination_rate, 
                                group = Gender, 
                                color = Gender)) + 
                     geom_point() + geom_line() + 
                     scale_x_discrete(limits = c("Sep","Oct","Nov","Dec","Jan","Feb"))
#adding a title to the plot 
plot_Gender_black_vax = plot_Gender_black_vax + 
  ggtitle("Vaccination Rates for Black population by Gender in 30815") + 
  theme(plot.title = 
          element_text(color="red", size=10, face="bold.italic")) + 
  labs(y = "Vaccination Total")
plot_Gender_black_vax
```

### Save plot
```{r}
#save figure
ggsave(filename = here("results","30815_Gender_black_vax.png"), plot=plot_Gender_black_vax)
```


### Turning ggplot into an interactive plot

```{r}
plotly_plot_Gender_black_vax = ggplotly(plot_Gender_black_vax)
plotly_plot_Gender_black_vax
```

## 30815 by age

### Loading the `processed_combined_30815.rds` file from `analysiscode.qmd`

```{r}
save_data_location = here("data", "processed_data","Zip_30815", "processed_combined_30815.rds")
processed_combined_30815 = readRDS(save_data_location)
```

### Loading the `processed_POP_combined_30815.rds`
```{r}
save_data_location = here("data", "processed_data","Zip_30815", "processed_POP_combined_30815.rds")
processed_POP_combined_30815 = readRDS(save_data_location)
```

### Dropping all variables except for black age groups within 30815

#### Using the select() function to subset the data frame by columns that start with an age group 

```{r}
processed_combined_30815_Age_black = processed_combined_30815 %>% 
  select(starts_with("total_05_09"), starts_with("total_10_17"), starts_with("total_18_44"), starts_with("total_45_64"), starts_with("total_65Plus"))
```

```{r}
processed_POP_combined_30815_Age_black = processed_POP_combined_30815 %>% 
  select(starts_with("total_05_09"), starts_with("total_10_17"), starts_with("total_18_44"), starts_with("total_45_64"), starts_with("total_65Plus"))
```

### Summing each Month variable by age group by month for vaccinations
```{r}
#Summing for ages 5-9 by month 
sum(processed_combined_30815_Age_black$total_05_09_vax_Sept_17) 
sum(processed_combined_30815_Age_black$total_05_09_vax_Oct_28) 
sum(processed_combined_30815_Age_black$total_05_09_vax_Nov_24) 
sum(processed_combined_30815_Age_black$total_05_09_vax_Dec_29) 
sum(processed_combined_30815_Age_black$total_05_09_vax_Jan_26) 
sum(processed_combined_30815_Age_black$total_05_09_vax_Feb_26)

#Summing for ages 10-17 by month 
sum(processed_combined_30815_Age_black$total_10_17_vax_Sept_17) 
sum(processed_combined_30815_Age_black$total_10_17_vax_Oct_28) 
sum(processed_combined_30815_Age_black$total_10_17_vax_Nov_24) 
sum(processed_combined_30815_Age_black$total_10_17_vax_Dec_29) 
sum(processed_combined_30815_Age_black$total_10_17_vax_Jan_26) 
sum(processed_combined_30815_Age_black$total_10_17_vax_Feb_26)

#Summing for ages 18-44 by month 
sum(processed_combined_30815_Age_black$total_18_44_vax_Sept_17) 
sum(processed_combined_30815_Age_black$total_18_44_vax_Oct_28) 
sum(processed_combined_30815_Age_black$total_18_44_vax_Nov_24) 
sum(processed_combined_30815_Age_black$total_18_44_vax_Dec_29) 
sum(processed_combined_30815_Age_black$total_18_44_vax_Jan_26) 
sum(processed_combined_30815_Age_black$total_18_44_vax_Feb_26)

#Summing for ages 45-64 by month 
sum(processed_combined_30815_Age_black$total_45_64_vax_Sept_17) 
sum(processed_combined_30815_Age_black$total_45_64_vax_Oct_28) 
sum(processed_combined_30815_Age_black$total_45_64_vax_Nov_24) 
sum(processed_combined_30815_Age_black$total_45_64_vax_Dec_29) 
sum(processed_combined_30815_Age_black$total_45_64_vax_Jan_26) 
sum(processed_combined_30815_Age_black$total_45_64_vax_Feb_26)

#Summing for ages 65+ by month 
sum(processed_combined_30815_Age_black$total_65Plus_vax_Sept_17) 
sum(processed_combined_30815_Age_black$total_65Plus_vax_Oct_28) 
sum(processed_combined_30815_Age_black$total_65Plus_vax_Nov_24) 
sum(processed_combined_30815_Age_black$total_65Plus_vax_Dec_29) 
sum(processed_combined_30815_Age_black$total_65Plus_vax_Jan_26) 
sum(processed_combined_30815_Age_black$total_65Plus_vax_Feb_26)

```

### Summing each Month variable by age group by month for Population
```{r}
#Summing for ages 5-9 by month 
sum(processed_POP_combined_30815_Age_black$total_05_09_POP_Sept_17) 
sum(processed_POP_combined_30815_Age_black$total_05_09_POP_Oct_28) 
sum(processed_POP_combined_30815_Age_black$total_05_09_POP_Nov_24) 
sum(processed_POP_combined_30815_Age_black$total_05_09_POP_Dec_29) 
sum(processed_POP_combined_30815_Age_black$total_05_09_POP_Jan_26) 
sum(processed_POP_combined_30815_Age_black$total_05_09_POP_Feb_26)

#Summing for ages 10-17 by month 
sum(processed_POP_combined_30815_Age_black$total_10_17_POP_Sept_17) 
sum(processed_POP_combined_30815_Age_black$total_10_17_POP_Oct_28) 
sum(processed_POP_combined_30815_Age_black$total_10_17_POP_Nov_24) 
sum(processed_POP_combined_30815_Age_black$total_10_17_POP_Dec_29) 
sum(processed_POP_combined_30815_Age_black$total_10_17_POP_Jan_26) 
sum(processed_POP_combined_30815_Age_black$total_10_17_POP_Feb_26)

#Summing for ages 18-44 by month 
sum(processed_POP_combined_30815_Age_black$total_18_44_POP_Sept_17) 
sum(processed_POP_combined_30815_Age_black$total_18_44_POP_Oct_28) 
sum(processed_POP_combined_30815_Age_black$total_18_44_POP_Nov_24) 
sum(processed_POP_combined_30815_Age_black$total_18_44_POP_Dec_29) 
sum(processed_POP_combined_30815_Age_black$total_18_44_POP_Jan_26) 
sum(processed_POP_combined_30815_Age_black$total_18_44_POP_Feb_26)

#Summing for ages 45-64 by month 
sum(processed_POP_combined_30815_Age_black$total_45_64_POP_Sept_17) 
sum(processed_POP_combined_30815_Age_black$total_45_64_POP_Oct_28) 
sum(processed_POP_combined_30815_Age_black$total_45_64_POP_Nov_24) 
sum(processed_POP_combined_30815_Age_black$total_45_64_POP_Dec_29) 
sum(processed_POP_combined_30815_Age_black$total_45_64_POP_Jan_26) 
sum(processed_POP_combined_30815_Age_black$total_45_64_POP_Feb_26)

#Summing for ages 65+ by month 
sum(processed_POP_combined_30815_Age_black$total_65Plus_POP_Sept_17) 
sum(processed_POP_combined_30815_Age_black$total_65Plus_POP_Oct_28) 
sum(processed_POP_combined_30815_Age_black$total_65Plus_POP_Nov_24) 
sum(processed_POP_combined_30815_Age_black$total_65Plus_POP_Dec_29) 
sum(processed_POP_combined_30815_Age_black$total_65Plus_POP_Jan_26) 
sum(processed_POP_combined_30815_Age_black$total_65Plus_POP_Feb_26)

```


### Separating sums by month into a data fram consisting of two variables: Date and Total Date contains months September-February #Total contains the vaccination totals for each month

```{r}
Age_Sum_by_month_30815 = data.frame(Date = c("Sep","Oct","Nov","Dec","Jan","Feb"),
                          Age_05_09 = c(201/2388, 213/2388, 211/2480, 215/2480, 211/2480, 211/2480),
                          Age_10_17 = c(1116/3604, 1113/3604, 1115/3604, 1118/3604, 1115/3604, 1114/3604),
                          Age_18_44 = c(5001/13358, 5009/13358, 5020/13358, 5026/13358, 5025/13358, 5032/13358),
                          Age_45_64 = c(5026/8431, 5017/8431, 5020/8431, 5009/8431, 5013/8431, 5020/8431),
                          Age_65Plus = c(2816/3590, 2825/3590, 2827/3590, 2814/3590, 2828/3590, 2832/3590))
                          
```

### Converting the Age_Sum_by_month_30815 to long data in order to plot
```{r}
Age_Sum_by_month_30815_long = reshape2::melt(Age_Sum_by_month_30815, id = "Date")
```


### Changing "variable" to "Age" and "value" to "Vaccination_total"

```{r}
Age_Sum_by_month_30815_long <- Age_Sum_by_month_30815_long %>% 
  rename("Age" = "variable") %>% 
  rename("Vaccination_rate" = "value")
```


### gglot2: Creating a line plot for the vaccination totals by month for the Black population by Age in the 30815 zip code

```{r}
plot_Age_black_vax = Age_Sum_by_month_30815_long %>% 
                     ggplot(aes(Date, Vaccination_rate, 
                                group = Age, 
                                color = Age)) + 
                     geom_point() + geom_line() + 
                     scale_x_discrete(limits = c("Sep","Oct","Nov","Dec","Jan","Feb"))
#adding a title to the plot 
plot_Age_black_vax = plot_Age_black_vax + 
  ggtitle("Vaccination Rates for Black population by Age in 30815") + 
  theme(plot.title = 
          element_text(color="red", size=10, face="bold.italic")) + 
  labs(y = "Vaccination Total")
plot_Age_black_vax
```


### Save plot
```{r}
#save figure
ggsave(filename = here("results","30815_Age_black_vax.png"), plot=plot_Age_black_vax)
```


### Turning ggplot into an interactive plot

```{r}
plotly_plot_Age_black_vax = ggplotly(plot_Age_black_vax)
plotly_plot_Age_black_vax
```

## 30907 by black residents 

## Zip code: 30907

### Combining Vaccination data from the 30907 zip from Sept-Feb
```{r}
# Loading September 30907
data_location1 = here("data", "processed_data", "Zip_30907", "processed_data_30907_Sept.rds")
processed_data_30907_Sept = readRDS(data_location1)

# Loading October 30907 and joining september and october 
data_location2 = here("data", "processed_data", "Zip_30907", "processed_data_30907_Oct.rds")
processed_data_30907_Oct = readRDS(data_location2)
processed_combined <- left_join(processed_data_30907_Sept, processed_data_30907_Oct, by = c("FIPS" = "FIPS"))

# Loading November 30907
data_location3 = here("data", "processed_data", "Zip_30907", "processed_data_30907_Nov.rds")
processed_data_30907_Nov = readRDS(data_location3)
processed_combined <- left_join(processed_combined, processed_data_30907_Nov, by = c("FIPS" = "FIPS"))

# Loading December 30907
data_location4 = here("data", "processed_data", "Zip_30907", "processed_data_30907_Dec.rds")
processed_data_30907_Dec = readRDS(data_location4)
processed_combined <- left_join(processed_combined, processed_data_30907_Dec, by = c("FIPS" = "FIPS"))

# Loading January 30907
data_location5 = here("data", "processed_data", "Zip_30907", "processed_data_30907_Jan.rds")
processed_data_30907_Jan = readRDS(data_location5)
processed_combined <- left_join(processed_combined, processed_data_30907_Jan, by = c("FIPS" = "FIPS"))

# Loading February 30907
data_location6 = here("data", "processed_data", "Zip_30907", "processed_data_30907_Feb.rds")
processed_data_30907_Feb = readRDS(data_location6)
processed_combined_30907 <- left_join(processed_combined, processed_data_30907_Feb, by = c("FIPS" = "FIPS"))
```

### Combining Population data from the 30907 zip from Sept-Feb
```{r}
# Loading September 30907
data_location1 = here("data", "processed_data", "Zip_30907", "processed_data_POP_30907_Sept.rds")
processed_data_POP_30907_Sept = readRDS(data_location1)

# Loading October 30907 and joining september and october 
data_location2 = here("data", "processed_data", "Zip_30907", "processed_data_POP_30907_Oct.rds")
processed_data_POP_30907_Oct = readRDS(data_location2)
processed_POP_combined <- left_join(processed_data_POP_30907_Sept, processed_data_POP_30907_Oct, by = c("FIPS" = "FIPS"))

# Loading November 30907
data_location3 = here("data", "processed_data", "Zip_30907", "processed_data_POP_30907_Nov.rds")
processed_data_POP_30907_Nov = readRDS(data_location3)
processed_POP_combined <- left_join(processed_POP_combined, processed_data_POP_30907_Nov, by = c("FIPS" = "FIPS"))

# Loading December 30907
data_location4 = here("data", "processed_data", "Zip_30907", "processed_data_POP_30907_Dec.rds")
processed_data_POP_30907_Dec = readRDS(data_location4)
processed_POP_combined <- left_join(processed_POP_combined, processed_data_POP_30907_Dec, by = c("FIPS" = "FIPS"))

# Loading January 30907
data_location5 = here("data", "processed_data", "Zip_30907", "processed_data_POP_30907_Jan.rds")
processed_data_POP_30907_Jan = readRDS(data_location5)
processed_POP_combined <- left_join(processed_POP_combined, processed_data_POP_30907_Jan, by = c("FIPS" = "FIPS"))

# Loading February 30907
data_location6 = here("data", "processed_data", "Zip_30907", "processed_data_POP_30907_Feb.rds")
processed_data_POP_30907_Feb = readRDS(data_location6)
processed_POP_combined_30907 <- left_join(processed_POP_combined, processed_data_POP_30907_Feb, by = c("FIPS" = "FIPS"))
```

### Saving the combined data for Black population for future use. Will be useful when stratifying the African American population by age and gender

```{r}
save_data_location = here("data", "processed_data","Zip_30907", "processed_combined_30907.rds")
saveRDS(processed_combined_30907, file = save_data_location)
```

```{r}
save_data_location = here("data", "processed_data","Zip_30907", "processed_POP_combined_30907.rds")
saveRDS(processed_POP_combined_30907, file = save_data_location)
```

### Dropping all variables except for total black variables in order to obtain vaccination rates of all Black population in the 30907 zip code

#### Using the select() function to subset the data frame by columns that start with "total_black_vax" which are variables with a total count of Black population with at least one dose of the COVID-19 vaccine by month

```{r}
processed_combined_30907_total_black = processed_combined_30907 %>% select(starts_with("total_black_vax"))
```

```{r}
processed_combined_30907_total_black_POP = processed_POP_combined_30907 %>% select(starts_with("total_black_POP"))
```

### Summing vaccination numbers
```{r}
#Summing each column for each month 
sum(processed_combined_30907_total_black$total_black_vax_Sept_17) 
sum(processed_combined_30907_total_black$total_black_vax_Oct_28) 
sum(processed_combined_30907_total_black$total_black_vax_Nov_24) 
sum(processed_combined_30907_total_black$total_black_vax_Dec_29) 
sum(processed_combined_30907_total_black$total_black_vax_Jan_26) 
sum(processed_combined_30907_total_black$total_black_vax_Feb_26) 
```

### Summing population numbers
```{r}
#Summing each column for each month 
sum(processed_combined_30907_total_black_POP$total_black_POP_Sept_17) 
sum(processed_combined_30907_total_black_POP$total_black_POP_Oct_28) 
sum(processed_combined_30907_total_black_POP$total_black_POP_Nov_24) 
sum(processed_combined_30907_total_black_POP$total_black_POP_Dec_29) 
sum(processed_combined_30907_total_black_POP$total_black_POP_Jan_26) 
sum(processed_combined_30907_total_black_POP$total_black_POP_Feb_26) 
```

#Separating sums by month into a data fram consisting of two variables: Date and VAX_RATE #Date contains months September-February #Total contains the vaccination totals for each month

```{r}
Sum_by_month_30907 = data.frame(Date = c("Sep","Oct","Nov","Dec","Jan","Feb"),
                               VAX_RATE = c(4956/9122, 4917/9189, 4888/9189, 4851/9189, 4866/9189, 4894/9189)) 
```

### gglot2: Creating a line plot for the vaccination totals by month for the African American population in the 30907 zip code

```{r}
plot_30907_total_black_vax_rate = Sum_by_month_30907 %>% 
  ggplot(aes(Date, VAX_RATE, group=1)) + 
  geom_point() + geom_line() + 
  scale_x_discrete(limits = c("Sep","Oct","Nov","Dec","Jan","Feb"))

#Adding a customization title for the plot 
plot_30907_total_black_vax_rate = plot_30907_total_black_vax_rate + 
  ggtitle("Vaccination Rates for Black Population in the 30907 Zipcode") + 
  theme(plot.title = 
          element_text(color="red", size=10, face="bold.italic"))
plot_30907_total_black_vax_rate
```

### Save plot
```{r}
#save figure
ggsave(filename = here("results","30907_total_black_vax_rate.png"), plot=plot_30907_total_black_vax_rate)
```


### Turning ggplot into an interactive plot

```{r}
plotly_30907_total_black_vax_rate = ggplotly(plot_30907_total_black_vax_rate)
plotly_30907_total_black_vax_rate
```

## Zip code 30907 by gender among residents that black 

## Zip code: 30907

### Loading the `processed_combined_30907.rds` 
```{r}
save_data_location = here("data", "processed_data","Zip_30907", "processed_combined_30907.rds")
processed_combined_30907 = readRDS(save_data_location)
```

### Loading the `processed_POP_combined_30907.rds`
```{r}
save_data_location = here("data", "processed_data","Zip_30907", "processed_POP_combined_30907.rds")
processed_POP_combined_30907 = readRDS(save_data_location)
```

### Dropping all variables except for black males and black females within 30907

#### Isolating Gender Variables form Vaccination data and Population data

```{r}
processed_combined_30907_Gender_black = processed_combined_30907 %>% select(matches("^total_(mblack|fblack)_vax"))
```

```{r}
processed_POP_combined_30907_Gender_black = processed_POP_combined_30907 %>% select(matches("^total_(mblack|fblack)_POP"))
```


### Summing each Month for vaccination data 
```{r}
#Summing for black males by month 
sum(processed_combined_30907_Gender_black$total_mblack_vax_Sept_17) 
sum(processed_combined_30907_Gender_black$total_mblack_vax_Oct_28) 
sum(processed_combined_30907_Gender_black$total_mblack_vax_Nov_24) 
sum(processed_combined_30907_Gender_black$total_mblack_vax_Dec_29) 
sum(processed_combined_30907_Gender_black$total_mblack_vax_Jan_26) 
sum(processed_combined_30907_Gender_black$total_mblack_vax_Feb_26)

#summing for black females by month 
sum(processed_combined_30907_Gender_black$total_fblack_vax_Sept_17) 
sum(processed_combined_30907_Gender_black$total_fblack_vax_Oct_28) 
sum(processed_combined_30907_Gender_black$total_fblack_vax_Nov_24) 
sum(processed_combined_30907_Gender_black$total_fblack_vax_Dec_29) 
sum(processed_combined_30907_Gender_black$total_fblack_vax_Jan_26) 
sum(processed_combined_30907_Gender_black$total_fblack_vax_Feb_26) 
```

### Summing each Month for population data
```{r}
#Summing for black males by month 
sum(processed_POP_combined_30907_Gender_black$total_mblack_POP_Sept_17) 
sum(processed_POP_combined_30907_Gender_black$total_mblack_POP_Oct_28) 
sum(processed_POP_combined_30907_Gender_black$total_mblack_POP_Nov_24) 
sum(processed_POP_combined_30907_Gender_black$total_mblack_POP_Dec_29) 
sum(processed_POP_combined_30907_Gender_black$total_mblack_POP_Jan_26) 
sum(processed_POP_combined_30907_Gender_black$total_mblack_POP_Feb_26)

#summing for black females by month 
sum(processed_POP_combined_30907_Gender_black$total_fblack_POP_Sept_17) 
sum(processed_POP_combined_30907_Gender_black$total_fblack_POP_Oct_28) 
sum(processed_POP_combined_30907_Gender_black$total_fblack_POP_Nov_24) 
sum(processed_POP_combined_30907_Gender_black$total_fblack_POP_Dec_29) 
sum(processed_POP_combined_30907_Gender_black$total_fblack_POP_Jan_26) 
sum(processed_POP_combined_30907_Gender_black$total_fblack_POP_Feb_26) 
```

#Separating sums by month into a data fram consisting of two variables: Date and Total Date contains months September-February #Total contains the vaccination totals for each month

```{r}
Gender_Sum_by_month_30907 = data.frame(Date = c("Sep","Oct","Nov","Dec","Jan","Feb"),
                          Male_Total = c(1947/4289, 1943/4289, 1926/4289, 1900/4289, 1913/4289, 1919/4289),
                          Female_Total = c(3009/4833, 2974/4900, 2962/4900, 2951/4900, 2953/4900, 2975/4900))
```

### Converting the Gender_Sum_by_month_30907 to long data in order to plot
```{r}
Gender_Sum_by_month_30907_long = reshape2::melt(Gender_Sum_by_month_30907, id = "Date")
```


### Changing "variable" to "Gender" and "value" to "Vaccination_total"

```{r}
Gender_Sum_by_month_30907_long <- Gender_Sum_by_month_30907_long %>% 
  rename("Gender" = "variable") %>% 
  rename("Vaccination_rate" = "value")
```


### gglot2: Creating a line plot for the vaccination totals by month for the Black population by gender in the 30907 zip code

```{r}
plot_Gender_black_vax = Gender_Sum_by_month_30907_long %>% 
                     ggplot(aes(Date, Vaccination_rate, 
                                group = Gender, 
                                color = Gender)) + 
                     geom_point() + geom_line() + 
                     scale_x_discrete(limits = c("Sep","Oct","Nov","Dec","Jan","Feb"))
#adding a title to the plot 
plot_Gender_black_vax = plot_Gender_black_vax + 
  ggtitle("Vaccination Rates for Black population by Gender in 30907") + 
  theme(plot.title = 
          element_text(color="red", size=10, face="bold.italic")) + 
  labs(y = "Vaccination Total")
plot_Gender_black_vax
```

### Save plot
```{r}
#save figure
ggsave(filename = here("results","30907_Gender_black_vax.png"), plot=plot_Gender_black_vax)
```


### Turning ggplot into an interactive plot

```{r}
plotly_plot_Gender_black_vax = ggplotly(plot_Gender_black_vax)
plotly_plot_Gender_black_vax
```

# Total Amount of vaccinations by Age among Black population in the Control Zip Code

## Zip code: 30907

### Loading the `processed_combined_30907.rds` file from `analysiscode.qmd`

```{r}
save_data_location = here("data", "processed_data","Zip_30907", "processed_combined_30907.rds")
processed_combined_30907 = readRDS(save_data_location)
```

### Loading the `processed_POP_combined_30907.rds`
```{r}
save_data_location = here("data", "processed_data","Zip_30907", "processed_POP_combined_30907.rds")
processed_POP_combined_30907 = readRDS(save_data_location)
```

### Dropping all variables except for black age groups within 30907

#### Using the select() function to subset the data frame by columns that start with an age group 

```{r}
processed_combined_30907_Age_black = processed_combined_30907 %>% 
  select(starts_with("total_05_09"), starts_with("total_10_17"), starts_with("total_18_44"), starts_with("total_45_64"), starts_with("total_65Plus"))
```

```{r}
processed_POP_combined_30907_Age_black = processed_POP_combined_30907 %>% 
  select(starts_with("total_05_09"), starts_with("total_10_17"), starts_with("total_18_44"), starts_with("total_45_64"), starts_with("total_65Plus"))
```

### Summing each Month variable by age group by month for vaccinations
```{r}
#Summing for ages 5-9 by month 
sum(processed_combined_30907_Age_black$total_05_09_vax_Sept_17) 
sum(processed_combined_30907_Age_black$total_05_09_vax_Oct_28) 
sum(processed_combined_30907_Age_black$total_05_09_vax_Nov_24) 
sum(processed_combined_30907_Age_black$total_05_09_vax_Dec_29) 
sum(processed_combined_30907_Age_black$total_05_09_vax_Jan_26) 
sum(processed_combined_30907_Age_black$total_05_09_vax_Feb_26)

#Summing for ages 10-17 by month 
sum(processed_combined_30907_Age_black$total_10_17_vax_Sept_17) 
sum(processed_combined_30907_Age_black$total_10_17_vax_Oct_28) 
sum(processed_combined_30907_Age_black$total_10_17_vax_Nov_24) 
sum(processed_combined_30907_Age_black$total_10_17_vax_Dec_29) 
sum(processed_combined_30907_Age_black$total_10_17_vax_Jan_26) 
sum(processed_combined_30907_Age_black$total_10_17_vax_Feb_26)

#Summing for ages 18-44 by month 
sum(processed_combined_30907_Age_black$total_18_44_vax_Sept_17) 
sum(processed_combined_30907_Age_black$total_18_44_vax_Oct_28) 
sum(processed_combined_30907_Age_black$total_18_44_vax_Nov_24) 
sum(processed_combined_30907_Age_black$total_18_44_vax_Dec_29) 
sum(processed_combined_30907_Age_black$total_18_44_vax_Jan_26) 
sum(processed_combined_30907_Age_black$total_18_44_vax_Feb_26)

#Summing for ages 45-64 by month 
sum(processed_combined_30907_Age_black$total_45_64_vax_Sept_17) 
sum(processed_combined_30907_Age_black$total_45_64_vax_Oct_28) 
sum(processed_combined_30907_Age_black$total_45_64_vax_Nov_24) 
sum(processed_combined_30907_Age_black$total_45_64_vax_Dec_29) 
sum(processed_combined_30907_Age_black$total_45_64_vax_Jan_26) 
sum(processed_combined_30907_Age_black$total_45_64_vax_Feb_26)

#Summing for ages 65+ by month 
sum(processed_combined_30907_Age_black$total_65Plus_vax_Sept_17) 
sum(processed_combined_30907_Age_black$total_65Plus_vax_Oct_28) 
sum(processed_combined_30907_Age_black$total_65Plus_vax_Nov_24) 
sum(processed_combined_30907_Age_black$total_65Plus_vax_Dec_29) 
sum(processed_combined_30907_Age_black$total_65Plus_vax_Jan_26) 
sum(processed_combined_30907_Age_black$total_65Plus_vax_Feb_26)

```

### Summing each Month variable by age group by month for Population
```{r}
#Summing for ages 5-9 by month 
sum(processed_POP_combined_30907_Age_black$total_05_09_POP_Sept_17) 
sum(processed_POP_combined_30907_Age_black$total_05_09_POP_Oct_28) 
sum(processed_POP_combined_30907_Age_black$total_05_09_POP_Nov_24) 
sum(processed_POP_combined_30907_Age_black$total_05_09_POP_Dec_29) 
sum(processed_POP_combined_30907_Age_black$total_05_09_POP_Jan_26) 
sum(processed_POP_combined_30907_Age_black$total_05_09_POP_Feb_26)

#Summing for ages 10-17 by month 
sum(processed_POP_combined_30907_Age_black$total_10_17_POP_Sept_17) 
sum(processed_POP_combined_30907_Age_black$total_10_17_POP_Oct_28) 
sum(processed_POP_combined_30907_Age_black$total_10_17_POP_Nov_24) 
sum(processed_POP_combined_30907_Age_black$total_10_17_POP_Dec_29) 
sum(processed_POP_combined_30907_Age_black$total_10_17_POP_Jan_26) 
sum(processed_POP_combined_30907_Age_black$total_10_17_POP_Feb_26)

#Summing for ages 18-44 by month 
sum(processed_POP_combined_30907_Age_black$total_18_44_POP_Sept_17) 
sum(processed_POP_combined_30907_Age_black$total_18_44_POP_Oct_28) 
sum(processed_POP_combined_30907_Age_black$total_18_44_POP_Nov_24) 
sum(processed_POP_combined_30907_Age_black$total_18_44_POP_Dec_29) 
sum(processed_POP_combined_30907_Age_black$total_18_44_POP_Jan_26) 
sum(processed_POP_combined_30907_Age_black$total_18_44_POP_Feb_26)

#Summing for ages 45-64 by month 
sum(processed_POP_combined_30907_Age_black$total_45_64_POP_Sept_17) 
sum(processed_POP_combined_30907_Age_black$total_45_64_POP_Oct_28) 
sum(processed_POP_combined_30907_Age_black$total_45_64_POP_Nov_24) 
sum(processed_POP_combined_30907_Age_black$total_45_64_POP_Dec_29) 
sum(processed_POP_combined_30907_Age_black$total_45_64_POP_Jan_26) 
sum(processed_POP_combined_30907_Age_black$total_45_64_POP_Feb_26)

#Summing for ages 65+ by month 
sum(processed_POP_combined_30907_Age_black$total_65Plus_POP_Sept_17) 
sum(processed_POP_combined_30907_Age_black$total_65Plus_POP_Oct_28) 
sum(processed_POP_combined_30907_Age_black$total_65Plus_POP_Nov_24) 
sum(processed_POP_combined_30907_Age_black$total_65Plus_POP_Dec_29) 
sum(processed_POP_combined_30907_Age_black$total_65Plus_POP_Jan_26) 
sum(processed_POP_combined_30907_Age_black$total_65Plus_POP_Feb_26)

```


### Separating sums by month into a data fram consisting of two variables: Date and Total Date contains months September-February #Total contains the vaccination totals for each month

```{r}
Age_Sum_by_month_30907 = data.frame(Date = c("Sep","Oct","Nov","Dec","Jan","Feb"),
                          Age_05_09 = c(244/2174, 239/2174, 241/2174, 236/2174, 240/2174, 242/2174),
                          Age_10_17 = c(1344/4070, 1358/4070, 1357/4070, 1341/4070, 1343/4070, 1335/4070),
                          Age_18_44 = c(9203/14571, 9217/14571, 9238/14571, 9245/14571, 9253/14571, 9246/14571),
                          Age_45_64 = c(6740/10362, 6700/10362, 6667/10362, 6626/10362, 6617/10362, 6624/10362),
                          Age_65Plus = c(6632/6995, 6633/6995, 6639/6995, 6635/6995, 6633/6995, 6623/6995))
                          
```

### Converting the Age_Sum_by_month_30907 to long data in order to plot
```{r}
Age_Sum_by_month_30907_long = reshape2::melt(Age_Sum_by_month_30907, id = "Date")
```


### Changing "variable" to "Age" and "value" to "Vaccination_total"

```{r}
Age_Sum_by_month_30907_long <- Age_Sum_by_month_30907_long %>% 
  rename("Age" = "variable") %>% 
  rename("Vaccination_rate" = "value")
```


### gglot2: Creating a line plot for the vaccination totals by month for the Black population by Age in the 30907 zip code

```{r}
plot_Age_black_vax = Age_Sum_by_month_30907_long %>% 
                     ggplot(aes(Date, Vaccination_rate, 
                                group = Age, 
                                color = Age)) + 
                     geom_point() + geom_line() + 
                     scale_x_discrete(limits = c("Sep","Oct","Nov","Dec","Jan","Feb"))
#adding a title to the plot 
plot_Age_black_vax = plot_Age_black_vax + 
  ggtitle("Vaccination Rates for Black population by Age in 30907") + 
  theme(plot.title = 
          element_text(color="red", size=10, face="bold.italic")) + 
  labs(y = "Vaccination Total")
plot_Age_black_vax
```


### Save plot
```{r}
#save figure
ggsave(filename = here("results","30907_Age_black_vax.png"), plot=plot_Age_black_vax)
```


### Turning ggplot into an interactive plot

```{r}
plotly_plot_Age_black_vax = ggplotly(plot_Age_black_vax)
plotly_plot_Age_black_vax
```
